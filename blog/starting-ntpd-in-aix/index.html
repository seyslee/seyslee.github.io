<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>AIX NTP 데몬 설정 &#183; seyslee</title><meta name=title content="AIX NTP 데몬 설정 &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/starting-ntpd-in-aix/><link type=text/css rel=stylesheet href=/css/main.bundle.min.cc396baef52cdb0a443160a5f7c70ca129c7814f8d0a548a73c6bbdaf93f314a3b54834993444ff2cbf4befcac49dd5324d335ea30822840c688a56c62658588.css integrity="sha512-zDlrrvUs2wpEMWCl98cMoSnHgU+NClSKc8a72vk/MUo7VINJk0RP8sv0vvysSd1TJNM16jCCKEDGiKVsYmWFiA=="><script type=text/javascript src=/js/appearance.min.12e98742cd283574d030a7fe55f29597df4ee214f7ff7075b4d19a64d046a602753c715295550be7899b661619cec89c679049d36c624681671a8013c1249896.js integrity="sha512-EumHQs0oNXTQMKf+VfKVl99O4hT3/3B1tNGaZNBGpgJ1PHFSlVUL54mbZhYZzsicZ5BJ02xiRoFnGoATwSSYlg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9ae0a991bb442898e9bc60cf318b4de3ff878325ff3821625a5564b32b2f66aec0e7f7d0e00ca3ac7df59d9f01c18c88b6bdd213184f86ac9ce06d7bdffbadf8.js integrity="sha512-muCpkbtEKJjpvGDPMYtN4/+HgyX/OCFiWlVksysvZq7A5/fQ4AyjrH31nZ8BwYyItr3SExhPhqyc4G173/ut+A==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="AIX NTP 데몬 설정"><meta property="og:description" content="IBM AIX 환경에서 명령어를 통한 NTP 데몬(xntpd) 설정, 시작, 상태확인하는 방법을 설명합니다."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/starting-ntpd-in-aix/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-10-26T21:00:45+09:00"><meta property="article:modified_time" content="2021-10-26T21:01:45+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="AIX NTP 데몬 설정"><meta name=twitter:description content="IBM AIX 환경에서 명령어를 통한 NTP 데몬(xntpd) 설정, 시작, 상태확인하는 방법을 설명합니다."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"AIX NTP 데몬 설정","headline":"AIX NTP 데몬 설정","description":"IBM AIX 환경에서 명령어를 통한 NTP 데몬(xntpd) 설정, 시작, 상태확인하는 방법을 설명합니다.","abstract":"개요 # IBM AIX의 클라이언트 서버에서 NTP 데몬을 동작후 NTP 서버와 시간 동기화하는 방법을 설명한다.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/starting-ntpd-in-aix\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2021","dateCreated":"2021-10-26T21:00:45\u002b09:00","datePublished":"2021-10-26T21:00:45\u002b09:00","dateModified":"2021-10-26T21:01:45\u002b09:00","keywords":["os","unix","aix"],"mainEntityOfPage":"true","wordCount":"808"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><nav><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class=relative><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">AIX NTP 데몬 설정</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-10-26 21:00:45 +0900 +0900">Oct 26, 2021</time><span class="px-2 text-primary-500">&#183;</span><time datetime="2021-10-26 21:01:45 +0900 +0900">Updated: Oct 26, 2021</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#개요>개요</a></li><li><a href=#증상>증상</a></li><li><a href=#환경>환경</a></li><li><a href=#해결법>해결법</a><ul><li><ul><li><a href=#1-ntp-데몬-상태확인>1. NTP 데몬 상태확인</a></li><li><a href=#2-ntp-설정파일-확인>2. NTP 설정파일 확인</a></li><li><a href=#3-ntp-서비스-기동>3. NTP 서비스 기동</a></li><li><a href=#4-ntp-데몬-동작상태-확인>4. NTP 데몬 동작상태 확인</a></li><li><a href=#5-ntp-수동-동기화-실행>5. NTP 수동 동기화 실행</a></li><li><a href=#6-ntp-동기화-여부-확인>6. NTP 동기화 여부 확인</a></li><li><a href=#7-ntp-자동시작-설정>7. NTP 자동시작 설정</a></li></ul></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=개요 class="relative group">개요 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b0%9c%ec%9a%94 aria-label=Anchor>#</a></span></h1><p>IBM AIX의 클라이언트 서버에서 NTP 데몬을 동작후 NTP 서버와 시간 동기화하는 방법을 설명한다.</p><p>어느날 내가 관리하는 IBM AIX 서버가 NTP 동기화가 안되고 있길래 점검하면서 공부할 겸 정리한 메뉴얼이다.</p><br><h1 id=증상 class="relative group">증상 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a6%9d%ec%83%81 aria-label=Anchor>#</a></span></h1><p>IBM AIX 클라이언트에서 NTP 서버와 시간 동기화가 불가능하다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ntpq -p</span>
</span></span><span class=line><span class=cl>ntpq: read: A remote host refused an attempted connect operation.
</span></span></code></pre></div><br><h1 id=환경 class="relative group">환경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h1><ul><li><strong>OS</strong> : IBM AIX 7.2.0.0</li><li><strong>Shell</strong> : ksh</li></ul><br><h1 id=해결법 class="relative group">해결법 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%95%b4%ea%b2%b0%eb%b2%95 aria-label=Anchor>#</a></span></h1><h3 id=1-ntp-데몬-상태확인 class="relative group">1. NTP 데몬 상태확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-ntp-%eb%8d%b0%eb%aa%ac-%ec%83%81%ed%83%9c%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p>IBM AIX에서 NTP 데몬의 이름은 <code>xntpd</code>이다. 리눅스의 경우는 <code>ntpd</code>. 가장 먼저 xntpd의 실행여부를 확인한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ps -ef | grep xntpd</span>
</span></span><span class=line><span class=cl>    root <span class=m>16449928</span>  <span class=m>8848040</span>   <span class=m>0</span> 08:25:49  pts/0  0:00 grep xntpd
</span></span></code></pre></div><p>xntpd 가 실행중이지 않다.</p><h3 id=2-ntp-설정파일-확인 class="relative group">2. NTP 설정파일 확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-ntp-%ec%84%a4%ec%a0%95%ed%8c%8c%ec%9d%bc-%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p>IBM AIX의 NTP 설정파일의 절대경로는 <code>/etc/ntp.conf</code>로 리눅스와 동일하다. 해당 설정파일을 수정하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># cat /etc/ntp.conf | grep -v ^#</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>broadcastclient
</span></span><span class=line><span class=cl>driftfile /etc/ntp.drift
</span></span><span class=line><span class=cl>tracefile /etc/ntp.trace
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>server 10.10.10.123 prefer
</span></span></code></pre></div><p>서버 IP 뒤에 <code>prefer</code>가 붙을 경우, 해당 NTP 서버와 우선적으로 연결한다.</p><p><code>grep -v ^#</code>는 주석을 제외하고 출력하겠다는 의미이다. 해당 NTP 설정파일 상단에는 제조사인 IBM에서 초기 작성한 주석이 너무 많아서(족히 한 30줄은 되는듯) 저 명령어로 필터링해서 출력하면 보기 편하다.</p><h3 id=3-ntp-서비스-기동 class="relative group">3. NTP 서비스 기동 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-ntp-%ec%84%9c%eb%b9%84%ec%8a%a4-%ea%b8%b0%eb%8f%99 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># startsrc -s xntpd -a &#34;-x&#34;</span>
</span></span><span class=line><span class=cl>0513-059 The xntpd Subsystem has been started. Subsystem PID is 19268504.
</span></span></code></pre></div><h4 id=startsrc-명령어-설명 class="relative group">startsrc 명령어 설명 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#startsrc-%eb%aa%85%eb%a0%b9%ec%96%b4-%ec%84%a4%eb%aa%85 aria-label=Anchor>#</a></span></h4><ul><li><code>-s</code> : 서비스 이름</li><li><code>-a</code> : 서비스 옵션 파라미터</li><li><code>"-x"</code> : 클라이언트의 시간이 뒤로 돌아가는 것을 방지하는 옵션</li></ul><h4 id=시간롤백-방지--x class="relative group">시간롤백 방지 &ldquo;-x&rdquo; <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%8b%9c%ea%b0%84%eb%a1%a4%eb%b0%b1-%eb%b0%a9%ec%a7%80--x aria-label=Anchor>#</a></span></h4><ul><li>만약 참조하는 NTP 서버(time server)가 현재 시간보다 과거시점으로 시간이 변경되었을 때, 해당 NTP 서버를 참조하는 클라이언트 측에서 시간이 뒤로 돌아가는 현상을 방지하기 위해서 xntpd 시작시, <code>-x</code> 옵션을 준다.</li><li>Oracle DB 서버의 경우 시간 롤백이 발생할 경우 충돌될 수 있으므로 반드시 xntpd 시작시 <code>-x</code> 옵션을 넣어서 시간이 뒤로 돌아가는 것(time backward)을 방지한다.</li></ul><h3 id=4-ntp-데몬-동작상태-확인 class="relative group">4. NTP 데몬 동작상태 확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-ntp-%eb%8d%b0%eb%aa%ac-%eb%8f%99%ec%9e%91%ec%83%81%ed%83%9c-%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ps -ef | grep xntpd</span>
</span></span><span class=line><span class=cl>    root <span class=m>11010996</span>  <span class=m>8848040</span>   <span class=m>0</span> 08:55:57  pts/0  0:00 grep xntpd
</span></span><span class=line><span class=cl>    root <span class=m>19268504</span>  <span class=m>3146712</span>   <span class=m>0</span> 08:55:54      -  0:00 /usr/sbin/xntpd -x
</span></span></code></pre></div><p>19268504 PID를 가진 xntpd 데몬이 <code>-x</code> 옵션이 붙은 상태로 잘 동작중이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># lssrc -s xntpd</span>
</span></span><span class=line><span class=cl>Subsystem         Group            PID          Status 
</span></span><span class=line><span class=cl> xntpd            tcpip            <span class=m>19268504</span>     active
</span></span></code></pre></div><p>xntpd의 PID는 <code>19268504</code>, 상태는 동작중(<code>active</code>)이다.</p><h3 id=5-ntp-수동-동기화-실행 class="relative group">5. NTP 수동 동기화 실행 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-ntp-%ec%88%98%eb%8f%99-%eb%8f%99%ea%b8%b0%ed%99%94-%ec%8b%a4%ed%96%89 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ntpdate -d 10.10.10.123</span>
</span></span><span class=line><span class=cl><span class=m>26</span> Oct 09:51:07 ntpdate<span class=o>[</span>16777548<span class=o>]</span>: 3.4y
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>server 10.10.10.123, port <span class=m>123</span>
</span></span><span class=line><span class=cl>stratum 1, precision -19, leap 00, trust <span class=m>000</span>
</span></span><span class=line><span class=cl>refid <span class=o>[</span>GPS<span class=o>]</span>, delay 0.02525, dispersion 0.00034
</span></span><span class=line><span class=cl>transmitted 4, in filter <span class=m>4</span>
</span></span><span class=line><span class=cl>reference time:      e521cf7a.00000000  Tue, Oct <span class=m>26</span> <span class=m>2021</span>  9:51:06.000
</span></span><span class=line><span class=cl>originate timestamp: e521cf7b.6dd2f12b  Tue, Oct <span class=m>26</span> <span class=m>2021</span>  9:51:07.429
</span></span><span class=line><span class=cl>transmit timestamp:  e521cf7b.6dd32000  Tue, Oct <span class=m>26</span> <span class=m>2021</span>  9:51:07.429
</span></span><span class=line><span class=cl>filter delay:  0.02649  0.02769  0.02525  0.02640 
</span></span><span class=line><span class=cl>               0.00000  0.00000  0.00000  0.00000 
</span></span><span class=line><span class=cl>filter offset: 0.000229 -0.00127 -0.00016 -0.00039
</span></span><span class=line><span class=cl>               0.000000 0.000000 0.000000 0.000000
</span></span><span class=line><span class=cl>delay 0.02525, dispersion 0.00034
</span></span><span class=line><span class=cl>offset -0.000160
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=m>26</span> Oct 09:51:07 ntpdate<span class=o>[</span>16777548<span class=o>]</span>: adjust <span class=nb>time</span> server 10.10.10.123 offset -0.00016
</span></span></code></pre></div><p>만약 <code>ntpdate -d</code> 실행후 <code>no server suitable for synchronization found</code> 에러 메세지가 발생할 경우, 아래 2가지 사항을 점검해보자.</p><ol><li><p>NTP 서버에서 NTP 데몬(리눅스의 경우 <code>ntpd</code>, AIX의 경우 <code>xntpd</code>)이 정상 동작중인가?</p></li><li><p>클라이언트와 NTP 서버 사이에 위치한 방화벽에서 NTP용 포트인 123번 포트가 통과 허용되어 있는가?</p></li></ol><p>transmit과 receive가 반복되면 서버와 클라이언트간 시간 데이터의 송수신이 잘되고 있다는 의미이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>receive<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl>transmit<span class=o>(</span>10.10.10.123<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></div><p>시간 오차값(offset)은 -0.000160</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl>offset -0.000160
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span></code></pre></div><h3 id=6-ntp-동기화-여부-확인 class="relative group">6. NTP 동기화 여부 확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#6-ntp-%eb%8f%99%ea%b8%b0%ed%99%94-%ec%97%ac%eb%b6%80-%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># ntpq -p</span>
</span></span><span class=line><span class=cl>     remote           refid      st t when poll reach   delay   offset    <span class=nv>disp</span>
</span></span><span class=line><span class=cl><span class=o>==============================================================================</span>
</span></span><span class=line><span class=cl>*10.10.10.123    .GPS.            <span class=m>1</span> u   <span class=m>20</span>   <span class=m>64</span>  <span class=m>377</span>     0.76    0.183    0.20
</span></span></code></pre></div><h4 id=ntpq-설명 class="relative group">ntpq 설명 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#ntpq-%ec%84%a4%eb%aa%85 aria-label=Anchor>#</a></span></h4><ul><li><p>IP 앞에 <code>*</code> 표시가 붙으면 해당 NTP 서버와 클라이언트가 정상적으로 동기화된 상태를 의미한다.</p></li><li><p><code>when</code> : NTP 서버로부터 데이터를 수신한 후 경과된 시간으로 데이터를 받으면 0으로 초기화된다. 단위는 초(second).</p></li><li><p><code>poll</code> : 클라이언트가 NTP 서버에 동기화 요청하는 주기. 단위는 초(second).</p></li><li><p><code>reach</code> : 최근 8번 Poll 요청에 대한 NTP 서버의 응답 여부. reach는 8진수로 표기된 값이다. 시간이 지날수록 오르면서 377에 도달하면 동기화가 완료된다.</p><table><thead><tr><th style=text-align:center>reach</th><th style=text-align:center>10진수</th><th style=text-align:center>2진수</th><th style=text-align:center>해석</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center>1</td><td style=text-align:center>0 0 0 0 0 0 0 1</td><td style=text-align:center>최근 8번 시도중 <strong>1번</strong> 성공</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>3</td><td style=text-align:center>0 0 0 0 0 0 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>2번</strong> 성공</td></tr><tr><td style=text-align:center>7</td><td style=text-align:center>7</td><td style=text-align:center>0 0 0 0 0 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>3번</strong> 성공</td></tr><tr><td style=text-align:center>17</td><td style=text-align:center>15</td><td style=text-align:center>0 0 0 0 1 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>4번</strong> 성공</td></tr><tr><td style=text-align:center>37</td><td style=text-align:center>31</td><td style=text-align:center>0 0 0 1 1 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>5번</strong> 성공</td></tr><tr><td style=text-align:center>77</td><td style=text-align:center>63</td><td style=text-align:center>0 0 1 1 1 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>6번</strong> 성공</td></tr><tr><td style=text-align:center>177</td><td style=text-align:center>127</td><td style=text-align:center>0 1 1 1 1 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>7번</strong> 성공</td></tr><tr><td style=text-align:center>377</td><td style=text-align:center>255</td><td style=text-align:center>1 1 1 1 1 1 1 1</td><td style=text-align:center>최근 8번 시도중 <strong>8번</strong> 성공</td></tr></tbody></table></li><li><p><code>delay</code> : 네트워크 지연시간. 단위는 밀리초(milisecond). <code>delay</code> 값이 5보다 작아야 한다.</p></li></ul><h3 id=7-ntp-자동시작-설정 class="relative group">7. NTP 자동시작 설정 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#7-ntp-%ec%9e%90%eb%8f%99%ec%8b%9c%ec%9e%91-%ec%84%a4%ec%a0%95 aria-label=Anchor>#</a></span></h3><p><code>/etc/rc.tcpip</code> : 부팅시 TCP/IP 데몬들과 Subsystem을 호출하는 설정 파일.</p><h4 id=작업전-설정파일 class="relative group">작업전 설정파일 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9e%91%ec%97%85%ec%a0%84-%ec%84%a4%ec%a0%95%ed%8c%8c%ec%9d%bc aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># vi /etc/rc.tcpip</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># Start up Network Time Protocol (NTP) daemon</span>
</span></span><span class=line><span class=cl><span class=c1>#start /usr/sbin/xntpd &#34;$src_running&#34; &#34;-x&#34;</span>
</span></span></code></pre></div><p><code>start /usr/sbin/xntpd ...</code> 라인의 주석을 제거해서 서버 재부팅 후에도 NTP Daemon이 자동 기동되도록 설정한다.
<code>-x</code> 옵션도 선언되어 있는지 잘 확인한다.</p><h4 id=작업후-설정파일 class="relative group">작업후 설정파일 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9e%91%ec%97%85%ed%9b%84-%ec%84%a4%ec%a0%95%ed%8c%8c%ec%9d%bc aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># vi /etc/rc.tcpip</span>
</span></span><span class=line><span class=cl><span class=o>[</span>...<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># Start up Network Time Protocol (NTP) daemon</span>
</span></span><span class=line><span class=cl>start /usr/sbin/xntpd <span class=s2>&#34;</span><span class=nv>$src_running</span><span class=s2>&#34;</span> <span class=s2>&#34;-x&#34;</span>
</span></span></code></pre></div></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>