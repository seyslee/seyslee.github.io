<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>docker 권한 문제 해결: /var/run/docker.sock permission denied &#183; seyslee</title><meta name=title content="docker 권한 문제 해결: /var/run/docker.sock permission denied &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/var-run-docker-sock-permission-denied/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fff8ff4cdbe2bf80930c53b6e47a6d9826b914a8623246481ff09ff52ea48fcfb403d9ba1dc7bbc800a7ecb15298c468838a661dd8ebb3e9f46fdca239b38a30.css integrity="sha512-//j/TNviv4CTDFO25HptmCa5FKhiMkZIH/Cf9S6kj8+0A9m6Hce7yACn7LFSmMRog4pmHdjrs+n0b9yiObOKMA=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="docker 권한 문제 해결: /var/run/docker.sock permission denied"><meta property="og:description" content="Jenkins에서 파이프라인 빌드시 발생하는 dial unix /var/run/docker.sock: connect: permission denied 오류를 해결하는 방법."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/var-run-docker-sock-permission-denied/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-01-11T22:17:15+09:00"><meta property="article:modified_time" content="2022-01-11T22:35:20+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="docker 권한 문제 해결: /var/run/docker.sock permission denied"><meta name=twitter:description content="Jenkins에서 파이프라인 빌드시 발생하는 dial unix /var/run/docker.sock: connect: permission denied 오류를 해결하는 방법."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"docker 권한 문제 해결: \/var\/run\/docker.sock permission denied","headline":"docker 권한 문제 해결: \/var\/run\/docker.sock permission denied","description":"Jenkins에서 파이프라인 빌드시 발생하는 dial unix \/var\/run\/docker.sock: connect: permission denied 오류를 해결하는 방법.","abstract":"# 증상 # Jenkins 파이프라인 스크립트를 짜고 파이프라인을 새로 만들었다.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/var-run-docker-sock-permission-denied\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2022","dateCreated":"2022-01-11T22:17:15\u002b09:00","datePublished":"2022-01-11T22:17:15\u002b09:00","dateModified":"2022-01-11T22:35:20\u002b09:00","keywords":["os","linux","docker","jenkins","devops"],"mainEntityOfPage":"true","wordCount":"750"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">docker 권한 문제 해결: /var/run/docker.sock permission denied</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-01-11 22:17:15 +0900 +0900">Jan 11, 2022</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#heading></a></li><li><a href=#증상>증상</a></li><li><a href=#환경>환경</a></li><li><a href=#원인>원인</a></li><li><a href=#해결방법>해결방법</a></li><li><a href=#상세-해결방법>상세 해결방법</a><ul><li><ul><li><a href=#호스트-서버>호스트 서버</a></li><li><a href=#jenkins-컨테이너-내부>Jenkins 컨테이너 내부</a></li></ul></li></ul></li><li><a href=#결론>결론</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=heading class="relative group"><span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#heading aria-label=Anchor>#</a></span></h1><h1 id=증상 class="relative group">증상 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a6%9d%ec%83%81 aria-label=Anchor>#</a></span></h1><p>Jenkins 파이프라인 스크립트를 짜고 파이프라인을 새로 만들었다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>// Testing jenkins slave node
</span></span><span class=line><span class=cl>node<span class=o>(</span>label: <span class=s1>&#39;builder&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  stage<span class=o>(</span><span class=s1>&#39;Preparation&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    git branch: <span class=s1>&#39;main&#39;</span>, url: <span class=s1>&#39;&lt;https://github.com/seyslee/nodejs-with-docker-toyproj.git&gt;&#39;</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl>  stage<span class=o>(</span><span class=s1>&#39;Build&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    def <span class=nv>myTestContainer</span> <span class=o>=</span> docker.image<span class=o>(</span><span class=s1>&#39;node:4.6&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    myTestContainer.pull<span class=o>()</span>
</span></span><span class=line><span class=cl>    myTestContainer.inside<span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      sh <span class=s1>&#39;npm install&#39;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><strong>Pipeline script 설명</strong> (테스트용의 엄청 단순한 코드다) <a href=https://github.com/seyslee/jenkins-pipeline-toyproj/blob/main/10-jenkins-slave/Jenkinsfile>Git 원본</a></p><ol><li>builder 라벨이 붙은 Jenkins 노드에서만 실행한다. 참고로 이 코드는 Jenkins slave이 정상 동작하는지 테스트하기 위한 코드다.</li><li>[Preparation 단계] 내 Docker 데모 레포지터리의 main branch를 Pull 한다.</li><li>[Build 단계] docker 이미지 <code>node:4.6</code>를 빌드한다.</li><li>[Build 단계] docker 컨테이너 안에서 <code>npm install</code> 명령어를 실행한다.</li></ol><br><p>Jenkins 웹페이지에서 만든 파이프라인을 빌드를 돌려보니 docker를 사용하는 단계<sup>Stage</sup>에서 아래와 같은 에러 메세지가 출력된다.</p><p><code>dial unix /var/run/docker.sock: connect: permission denied</code></p><br><p><strong>자세한 Stages Logs</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>+ docker pull node:4.6
</span></span><span class=line><span class=cl>Warning: failed to get default registry endpoint from daemon <span class=o>(</span>Got permission denied <span class=k>while</span> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get http://%2Fvar%2Frun%2Fdocker.sock/v1.26/info: dial unix /var/run/docker.sock: connect: permission denied<span class=o>)</span>. Using system default: &lt;https://index.docker.io/v1/&gt;
</span></span><span class=line><span class=cl>Got permission denied <span class=k>while</span> trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Post http://%2Fvar%2Frun%2Fdocker.sock/v1.26/images/create?fromImage<span class=o>=</span>node<span class=p>&amp;</span><span class=nv>tag</span><span class=o>=</span>4.6: dial unix /var/run/docker.sock: connect: permission denied
</span></span></code></pre></div><br><p><strong>Jenkins 에러 메세지 화면</strong></p><p><figure><img class="my-0 rounded-md" src=./1.jpg alt=Untitled></figure></p><p>docker 에러로 인해 내가 만든 Pipeline을 제대로 빌드할 수 없는 상황이다.</p><br><h1 id=환경 class="relative group">환경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h1><p><strong>호스트 환경정보</strong></p><ul><li><strong>OS</strong> : Ubuntu 20.04.3 LTS</li><li><strong>Shell</strong> : bash</li><li><strong>ID</strong> : root</li><li><strong>Docker</strong> : Docker version 20.10.12, build e91ed57</li><li><strong>Jenkins Server</strong> : Jenkins 2.319.1 (도커 컨테이너 형태로 배포됨)</li></ul><br><p><strong>호스트의 Docker 구성</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ docker ps
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE                      COMMAND            CREATED       STATUS       PORTS                                   NAMES
</span></span><span class=line><span class=cl>170a33da3a09   wardviaene/jenkins-slave   <span class=s2>&#34;/entrypoint.sh&#34;</span>   <span class=m>2</span> hours ago   Up <span class=m>2</span> hours   0.0.0.0:2222-&gt;22/tcp, :::2222-&gt;22/tcp   suspicious_goldstine
</span></span></code></pre></div><p>현재 내 경우는 jenkins를 docker 컨테이너 형태로 띄워서 사용중이다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ docker run -p 2222:22 -v /var/jenkins_home:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock --restart always -d wardviaene/jenkins-slave
</span></span></code></pre></div><p>호스트 서버의 <code>/var/run/docker.sock</code> 파일을 컨테이너에 공유해서 사용 중이다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls -lh /var/run/docker.sock
</span></span><span class=line><span class=cl>srw-rw---- <span class=m>1</span> root systemd-coredump <span class=m>0</span> Jan <span class=m>11</span> 10:35 /var/run/docker.sock
</span></span></code></pre></div><p>호스트 서버에서 확인한 <code>/var/run/docker.sock</code> 파일. 현재 내 구성은 이 <code>docker.sock</code> 파일을 젠킨스 컨테이너와 공유하도록 볼륨 매핑되어 있다.</p><br><h1 id=원인 class="relative group">원인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9b%90%ec%9d%b8 aria-label=Anchor>#</a></span></h1><p>jenkins 컨테이너가 사용하는 <code>docker.sock</code> 파일의 권한 설정 문제</p><br><h1 id=해결방법 class="relative group">해결방법 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%95%b4%ea%b2%b0%eb%b0%a9%eb%b2%95 aria-label=Anchor>#</a></span></h1><p>컨테이너 내부의 <code>/var/run/docker.sock</code> 파일에 알맞은 그룹 권한 <code>docker</code>을 부여한다.</p><br><h1 id=상세-해결방법 class="relative group">상세 해결방법 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%83%81%ec%84%b8-%ed%95%b4%ea%b2%b0%eb%b0%a9%eb%b2%95 aria-label=Anchor>#</a></span></h1><h3 id=호스트-서버 class="relative group">호스트 서버 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%98%b8%ec%8a%a4%ed%8a%b8-%ec%84%9c%eb%b2%84 aria-label=Anchor>#</a></span></h3><p>Jenkins 컨테이너가 구동되고 있는 호스트 서버에 접속한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ docker ps
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE                      COMMAND            CREATED       STATUS       PORTS                                   NAMES
</span></span><span class=line><span class=cl>170a33da3a09   wardviaene/jenkins-slave   <span class=s2>&#34;/entrypoint.sh&#34;</span>   <span class=m>2</span> hours ago   Up <span class=m>2</span> hours   0.0.0.0:2222-&gt;22/tcp, :::2222-&gt;22/tcp   suspicious_goldstine
</span></span></code></pre></div><p>현재 구성은 호스트 서버 위에서 jenkins가 컨테이너 형태로 운영중인 구성이다.</p><br><p>jenkins 컨테이너에 bash 쉘로 접속한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ docker <span class=nb>exec</span> -it 170a33da3a09 bash
</span></span></code></pre></div><br><h3 id=jenkins-컨테이너-내부 class="relative group">Jenkins 컨테이너 내부 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#jenkins-%ec%bb%a8%ed%85%8c%ec%9d%b4%eb%84%88-%eb%82%b4%eb%b6%80 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ id
</span></span><span class=line><span class=cl><span class=nv>uid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>gid</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span> <span class=nv>groups</span><span class=o>=</span>0<span class=o>(</span>root<span class=o>)</span>
</span></span></code></pre></div><p>bash 명령어로 Jenkins 컨테이너에 root ID로 들어왔다.</p><br><p>컨테이너 내부에서 <code>docker.sock</code> 파일의 존재여부와 권한을 확인한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls -al /var/run/
</span></span><span class=line><span class=cl>total <span class=m>20</span>
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root <span class=m>4096</span> Jan <span class=m>11</span> 10:36 .
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>1</span> root root <span class=m>4096</span> Jan <span class=m>11</span> 10:36 ..
</span></span><span class=line><span class=cl>srw-rw---- <span class=m>1</span> root  <span class=m>998</span>    <span class=m>0</span> Jan <span class=m>11</span> 10:35 docker.sock
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>2</span> root root <span class=m>4096</span> May  <span class=m>8</span>  <span class=m>2017</span> lock
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root <span class=m>4096</span> Jun  <span class=m>9</span>  <span class=m>2017</span> sshd
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root    <span class=m>4</span> Jan <span class=m>11</span> 10:36 sshd.pid
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> root utmp    <span class=m>0</span> May  <span class=m>8</span>  <span class=m>2017</span> utmp
</span></span></code></pre></div><p><code>docker.sock</code> 파일의 그룹 권한이 이름이 없고 GID <code>998</code>만 적혀있다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /etc/group <span class=p>|</span> grep <span class=m>998</span>
</span></span><span class=line><span class=cl>$ <span class=c1>## 결과가 출력되지 않음 = 998번 그룹이 없다</span>
</span></span></code></pre></div><p>컨테이너 내부에서 <u>GID <code>998</code>에 해당하는 Group이 없기 때문에</u> 그룹 이름이 아닌 <code>998</code>로만 표시되는 것이다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat /etc/group <span class=p>|</span> grep docker
</span></span><span class=line><span class=cl>docker❌999:jenkins
</span></span></code></pre></div><p>컨테이너의 기준에서 jenkins 유저가 속해있는 <code>docker</code> 그룹의 GID는 <code>999</code>이다.</p><br><p>컨테이너 내부에 위치한 <code>docker.sock</code> 파일의 그룹 권한이 이상하기 때문에 GID <code>999</code>를 가진 <code>docker</code> 그룹에 다시 연결해주도록 하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ sudo chown root:docker /var/run/docker.sock
</span></span><span class=line><span class=cl>bash: sudo: <span class=nb>command</span> not found
</span></span></code></pre></div><p><code>sudo</code> 명령어가 존재하지 않는 컨테이너도 있으니 당황하지 말자.</p><br><p><code>docker.sock</code> 파일의 소유자 권한을 <code>root</code>, 소유 그룹을 <code>docker</code>로 변경한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ chown root:docker /var/run/docker.sock
</span></span></code></pre></div><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ ls -lh /var/run/
</span></span><span class=line><span class=cl>total 12K
</span></span><span class=line><span class=cl>srw-rw---- <span class=m>1</span> root docker    <span class=m>0</span> Jan <span class=m>11</span> 10:35 docker.sock
</span></span><span class=line><span class=cl>drwxrwxrwt <span class=m>2</span> root root   4.0K May  <span class=m>8</span>  <span class=m>2017</span> lock
</span></span><span class=line><span class=cl>drwxr-xr-x <span class=m>2</span> root root   4.0K Jun  <span class=m>9</span>  <span class=m>2017</span> sshd
</span></span><span class=line><span class=cl>-rw-r--r-- <span class=m>1</span> root root      <span class=m>4</span> Jan <span class=m>11</span> 10:36 sshd.pid
</span></span><span class=line><span class=cl>-rw-rw-r-- <span class=m>1</span> root utmp      <span class=m>0</span> May  <span class=m>8</span>  <span class=m>2017</span> utmp
</span></span></code></pre></div><p><code>docker.sock</code> 파일의 그룹 권한이 <code>docker</code>로 변경되었다.</p><p>도커 소켓파일의 권한에 대한 조치는 완료됐다.</p><br><p>Jenkins 웹페이지로 돌아간다.</p><p><figure><img class="my-0 rounded-md" src=./2.jpg alt=Untitled></figure></p><p>[Build Now] 버튼을 클릭해서 처음에 build 실패한 Pipeline을 다시 빌드해보자.</p><br><p>컨테이너의 <code>docker.sock</code> 파일의 소유 그룹을 <code>docker</code> 로 맞춰준 후부터 빌드가 잘 완료된다.</p><p><figure><img class="my-0 rounded-md" src=./3.jpg alt></figure></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.....
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> // stage
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> stage
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> <span class=o>{</span> <span class=o>(</span>Build<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> isUnix
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> sh
</span></span><span class=line><span class=cl>+ docker pull node:4.6
</span></span><span class=line><span class=cl>4.6: Pulling from library/node
</span></span><span class=line><span class=cl>Digest: sha256:a1cc6d576734c331643f9c4e0e7f572430e8baf9756dc24dab11d87b34bd202e
</span></span><span class=line><span class=cl>Status: Image is up to date <span class=k>for</span> node:4.6
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> isUnix
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> sh
</span></span><span class=line><span class=cl>.....
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> // node
</span></span><span class=line><span class=cl><span class=o>[</span>Pipeline<span class=o>]</span> End of Pipeline
</span></span><span class=line><span class=cl>Finished: SUCCESS
</span></span></code></pre></div><p>Jenkins 빌드 로그에서 볼 때도 문제가 발생했던 <code>docker pull node:4.6</code> 부분에서도 정상적으로 이미지를 가져온다.</p><br><h1 id=결론 class="relative group">결론 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b2%b0%eb%a1%a0 aria-label=Anchor>#</a></span></h1><p>이 이슈는 조치는 간단한데 생각보다 귀찮고 당황스럽다.</p><p><code>Permission denied</code> 에러를 처음 마주했을 때는 낯설고 무서웠지만 이제는 감흥도 없고 조치가 익숙하다.</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article><div class="absolute top-[100vh] ltr:right-0 rtl:left-0 w-12 pointer-events-none bottom-0"><a href=#the-top class="w-12 h-12 sticky pointer-events-auto top-[calc(100vh-5.5rem)] bg-neutral/50 dark:bg-neutral-800/50 backdrop-blur rounded-full text-xl flex items-center justify-center text-neutral-700 dark:text-neutral hover:text-primary-600 dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div></div></footer></div></body></html>