<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>오라클 세션 확인하고 Kill &#183; seyslee</title><meta name=title content="오라클 세션 확인하고 Kill &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/killing-locked-session-in-oracle-database/><link type=text/css rel=stylesheet href=/css/main.bundle.min.980311a18ad0b55ec626a015b02d8161dc5f9d2c385a9806100e43c16f86e2fd1b824521ff0017c49f7a84d11834247d5741e87d58473a289ef870e9f3d13c02.css integrity="sha512-mAMRoYrQtV7GJqAVsC2BYdxfnSw4WpgGEA5DwW+G4v0bgkUh/wAXxJ96hNEYNCR9V0HofVhHOiie+HDp89E8Ag=="><script type=text/javascript src=/js/appearance.min.12e98742cd283574d030a7fe55f29597df4ee214f7ff7075b4d19a64d046a602753c715295550be7899b661619cec89c679049d36c624681671a8013c1249896.js integrity="sha512-EumHQs0oNXTQMKf+VfKVl99O4hT3/3B1tNGaZNBGpgJ1PHFSlVUL54mbZhYZzsicZ5BJ02xiRoFnGoATwSSYlg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9ae0a991bb442898e9bc60cf318b4de3ff878325ff3821625a5564b32b2f66aec0e7f7d0e00ca3ac7df59d9f01c18c88b6bdd213184f86ac9ce06d7bdffbadf8.js integrity="sha512-muCpkbtEKJjpvGDPMYtN4/+HgyX/OCFiWlVksysvZq7A5/fQ4AyjrH31nZ8BwYyItr3SExhPhqyc4G173/ut+A==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="오라클 세션 확인하고 Kill"><meta property="og:description" content="락 걸린 오라클 세션을 확인한 후 강제종료(Kill) 조치하는 방법"><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/killing-locked-session-in-oracle-database/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-09-08T20:48:20+09:00"><meta property="article:modified_time" content="2021-09-08T20:48:20+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="오라클 세션 확인하고 Kill"><meta name=twitter:description content="락 걸린 오라클 세션을 확인한 후 강제종료(Kill) 조치하는 방법"><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"오라클 세션 확인하고 Kill","headline":"오라클 세션 확인하고 Kill","description":"락 걸린 오라클 세션을 확인한 후 강제종료(Kill) 조치하는 방법","abstract":"개요 # 오라클 DB에서 세션 상태를 확인하고 Lock이 발생한 비정상적인 DB 세션을 강제종료(Kill)할 수 있다.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/killing-locked-session-in-oracle-database\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2021","dateCreated":"2021-09-08T20:48:20\u002b09:00","datePublished":"2021-09-08T20:48:20\u002b09:00","dateModified":"2021-09-08T20:48:20\u002b09:00","keywords":["database","oracle"],"mainEntityOfPage":"true","wordCount":"243"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><nav><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class=relative><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">오라클 세션 확인하고 Kill</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-09-08 20:48:20 +0900 +0900">Sep 8, 2021</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#개요>개요</a></li><li><a href=#작성배경>작성배경</a></li><li><a href=#환경>환경</a></li><li><a href=#작업절차>작업절차</a><ul><li><ul><li><a href=#1-oracle-계정-접속>1. oracle 계정 접속</a></li><li><a href=#2-db-접속>2. DB 접속</a></li><li><a href=#3-db-세션-상태확인>3. DB 세션 상태확인</a></li><li><a href=#4-db-세션-강제종료kill>4. DB 세션 강제종료(Kill)</a></li><li><a href=#5-db-세션-재확인>5. DB 세션 재확인</a></li></ul></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=개요 class="relative group">개요 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b0%9c%ec%9a%94 aria-label=Anchor>#</a></span></h1><p>오라클 DB에서 세션 상태를 확인하고 Lock이 발생한 비정상적인 DB 세션을 강제종료(Kill)할 수 있다.</p><h1 id=작성배경 class="relative group">작성배경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9e%91%ec%84%b1%eb%b0%b0%ea%b2%bd aria-label=Anchor>#</a></span></h1><p>가끔씩 운영중인 DB서버에서 Application 에러로 Query가 비정상적으로 반복실행되면서 시스템 부하가 급증하는 상황이 발생한다.<br>어느날 개발자로부터 세션 강제종료(Kill) 조치 요청이 들어와 조치한 기록이다.</p><h1 id=환경 class="relative group">환경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h1><ul><li><strong>OS</strong> : HP-UX B.11.31</li><li><strong>ID</strong> : oracle</li><li><strong>Shell</strong> : sh</li><li><strong>Database</strong> : Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production</li></ul><h1 id=작업절차 class="relative group">작업절차 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9e%91%ec%97%85%ec%a0%88%ec%b0%a8 aria-label=Anchor>#</a></span></h1><h3 id=1-oracle-계정-접속 class="relative group">1. oracle 계정 접속 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-oracle-%ea%b3%84%ec%a0%95-%ec%a0%91%ec%86%8d aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ su - oracle
</span></span></code></pre></div><h3 id=2-db-접속 class="relative group">2. DB 접속 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-db-%ec%a0%91%ec%86%8d aria-label=Anchor>#</a></span></h3><p>DB에 접속한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>$ sqlplus / as sysdba
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SQL*Plus: Release 11.2.0.4.0 Production on Wed Sep <span class=m>8</span> 15:46:26 <span class=m>2021</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Copyright <span class=o>(</span>c<span class=o>)</span> 1982, 2013, Oracle.  All rights reserved.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Connected to:
</span></span><span class=line><span class=cl>Oracle Database 11g Enterprise Edition Release 11.2.0.4.0 - 64bit Production
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SQL&gt;
</span></span></code></pre></div><h3 id=3-db-세션-상태확인 class="relative group">3. DB 세션 상태확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-db-%ec%84%b8%ec%85%98-%ec%83%81%ed%83%9c%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p><strong>Oracle Session</strong></p><ul><li>Oracle 데이터베이스는 사용자와 데이터베이스 접속이 이루어지면 세션을 생성한다. 세션은 사용자가 데이터베이스에 연결되어 있는 동안 계속 유지되고, 각 세션에는 Session ID(<code>SID</code>)와 Serial 번호(<code>Serial#</code>)가 부여된다.</li><li>Session ID(<code>SID</code>)와 Serial 번호(<code>Serial#</code>)가 같이 부여되는 이유는 Session이 종료되었으나, 다른 세션이 동일한 SID를 갖고 시작되었을 때 세션 명령들이 정확한 세션에 적용될 수 있도록 하기 위해서이다.</li><li>세션이 사용자에 의해 작업중이라면 <code>ACTIVE</code> 상태로 작업을 하게된다. <code>INACTIVE</code> 상태는 세션은 연결되어있지만 작업을 하고있지 않는 상태를 의미한다.</li></ul><p><strong>명령어 형식</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SQL</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>SID</span><span class=p>,</span><span class=w> </span><span class=nb>SERIAL</span><span class=o>#</span><span class=p>,</span><span class=w> </span><span class=n>USERNAME</span><span class=p>,</span><span class=w> </span><span class=n>PROGRAM</span><span class=p>,</span><span class=w> </span><span class=n>STATUS</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>V$SESSION</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SID</span><span class=o>=</span><span class=s1>&#39;&lt;SID&gt;&#39;</span><span class=p>;</span><span class=w>
</span></span></span></code></pre></div><p><strong>실행 명령어</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SQL</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>SID</span><span class=p>,</span><span class=w> </span><span class=nb>SERIAL</span><span class=o>#</span><span class=p>,</span><span class=w> </span><span class=n>USERNAME</span><span class=p>,</span><span class=w> </span><span class=n>PROGRAM</span><span class=p>,</span><span class=w> </span><span class=n>STATUS</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>V$SESSION</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SID</span><span class=o>=</span><span class=s1>&#39;657&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>SID</span><span class=w>    </span><span class=nb>SERIAL</span><span class=o>#</span><span class=w> </span><span class=n>USERNAME</span><span class=w>                       </span><span class=n>PROGRAM</span><span class=w>                                          </span><span class=n>STATUS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------- ---------- ------------------------------ ------------------------------------------------ --------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>       </span><span class=mi>657</span><span class=w>      </span><span class=mi>13469</span><span class=w> </span><span class=n>DEV</span><span class=w>                            </span><span class=k>SQL</span><span class=w> </span><span class=n>Developer</span><span class=w>                                    </span><span class=n>ACTIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>.</span><span class=mi>01</span><span class=w>
</span></span></span></code></pre></div><h3 id=4-db-세션-강제종료kill class="relative group">4. DB 세션 강제종료(Kill) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-db-%ec%84%b8%ec%85%98-%ea%b0%95%ec%a0%9c%ec%a2%85%eb%a3%8ckill aria-label=Anchor>#</a></span></h3><p>세션을 강제로 끊어버리기 위해서는 Session ID(<code>SID</code>)와 Serial 번호(<code>SERIAL#</code>) 정보가 필요하다.</p><p><strong>명령어 형식</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SQL</span><span class=o>&gt;</span><span class=w> </span><span class=k>ALTER</span><span class=w> </span><span class=k>SYSTEM</span><span class=w> </span><span class=n>KILL</span><span class=w> </span><span class=k>SESSION</span><span class=w> </span><span class=s1>&#39;&lt;SID&gt;, &lt;SERIAL#&gt;&#39;</span><span class=w>
</span></span></span></code></pre></div><p><strong>실행 명령어</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SQL</span><span class=o>&gt;</span><span class=w> </span><span class=k>ALTER</span><span class=w> </span><span class=k>SYSTEM</span><span class=w> </span><span class=n>KILL</span><span class=w> </span><span class=k>SESSION</span><span class=w> </span><span class=s1>&#39;657, 13469&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=k>System</span><span class=w> </span><span class=n>altered</span><span class=p>.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>01</span><span class=p>.</span><span class=mi>01</span><span class=w>
</span></span></span></code></pre></div><p>세션 강제종료(Kill)가 정상적으로 실행되었다.</p><h3 id=5-db-세션-재확인 class="relative group">5. DB 세션 재확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-db-%ec%84%b8%ec%85%98-%ec%9e%ac%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p>13469번 Serial Number(<code>SERIAL#</code>)를 가진 세션이 사라진 걸 확인할 수 있다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>SQL</span><span class=o>&gt;</span><span class=w> </span><span class=k>SELECT</span><span class=w> </span><span class=n>SID</span><span class=p>,</span><span class=w> </span><span class=nb>SERIAL</span><span class=o>#</span><span class=p>,</span><span class=w> </span><span class=n>USERNAME</span><span class=p>,</span><span class=w> </span><span class=n>PROGRAM</span><span class=p>,</span><span class=w> </span><span class=n>STATUS</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>V$SESSION</span><span class=w> </span><span class=k>WHERE</span><span class=w> </span><span class=n>SID</span><span class=o>=</span><span class=s1>&#39;657&#39;</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=n>SID</span><span class=w>    </span><span class=nb>SERIAL</span><span class=o>#</span><span class=w> </span><span class=n>USERNAME</span><span class=w>                       </span><span class=n>PROGRAM</span><span class=w>                                          </span><span class=n>STATUS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c1>---------- ---------- ------------------------------ ------------------------------------------------ --------
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=w>       </span><span class=mi>657</span><span class=w>      </span><span class=mi>13478</span><span class=w> </span><span class=n>DEV</span><span class=w>                            </span><span class=n>oracle</span><span class=o>@</span><span class=n>devdb1</span><span class=w> </span><span class=p>(</span><span class=n>TNS</span><span class=w> </span><span class=n>V1</span><span class=o>-</span><span class=n>V3</span><span class=p>)</span><span class=w>                        </span><span class=n>INACTIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=n>Elapsed</span><span class=p>:</span><span class=w> </span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>:</span><span class=mi>00</span><span class=p>.</span><span class=mi>00</span><span class=w>
</span></span></span></code></pre></div></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>