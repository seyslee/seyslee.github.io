<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>Kubernetes 설치 &#183; seyslee</title><meta name=title content="Kubernetes 설치 &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/k8s/installing-k8s-on-mac/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fff8ff4cdbe2bf80930c53b6e47a6d9826b914a8623246481ff09ff52ea48fcfb403d9ba1dc7bbc800a7ecb15298c468838a661dd8ebb3e9f46fdca239b38a30.css integrity="sha512-//j/TNviv4CTDFO25HptmCa5FKhiMkZIH/Cf9S6kj8+0A9m6Hce7yACn7LFSmMRog4pmHdjrs+n0b9yiObOKMA=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="Kubernetes 설치"><meta property="og:description" content="macOS에서 kubernetes 설치, 구축, 테스트하는 방법을 설명합니다."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/k8s/installing-k8s-on-mac/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-07T17:19:30+09:00"><meta property="article:modified_time" content="2021-11-08T01:21:25+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kubernetes 설치"><meta name=twitter:description content="macOS에서 kubernetes 설치, 구축, 테스트하는 방법을 설명합니다."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"Kubernetes 설치","headline":"Kubernetes 설치","description":"macOS에서 kubernetes 설치, 구축, 테스트하는 방법을 설명합니다.","abstract":"개요 # macOS 로컬환경에서 Kubernetes 실습을 할 수 있도록 쿠버네티스 설치 과정을 설명한다.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/k8s\/installing-k8s-on-mac\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2021","dateCreated":"2021-11-07T17:19:30\u002b09:00","datePublished":"2021-11-07T17:19:30\u002b09:00","dateModified":"2021-11-08T01:21:25\u002b09:00","keywords":["devops","kubernetes"],"mainEntityOfPage":"true","wordCount":"807"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Kubernetes 설치</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-11-07 17:19:30 +0900 +0900">Nov 7, 2021</time></div><div class="my-1 text-xs text-neutral-500 dark:text-neutral-400"><a href=/tags/devops/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">devops</a>
<a href=/tags/kubernetes/ class="px-1 py-[1px] border rounded-md border-neutral-200 dark:border-neutral-600 hover:border-primary-300 hover:text-primary-700 dark:hover:border-primary-600 dark:hover:text-primary-400">kubernetes</a></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#개요>개요</a></li><li><a href=#환경>환경</a></li><li><a href=#절차>절차</a><ul><li><ul><li><a href=#1-docker-설치>1. Docker 설치</a></li><li><a href=#2-kubernetes-활성화>2. kubernetes 활성화</a></li><li><a href=#3-kubernetes-상태-확인>3. kubernetes 상태 확인</a></li><li><a href=#4-pod-스펙-작성>4. pod 스펙 작성</a></li><li><a href=#5-pod-배포>5. pod 배포</a></li><li><a href=#6-pod-상태확인>6. pod 상태확인</a></li><li><a href=#7-배포-결과확인>7. 배포 결과확인</a></li><li><a href=#8-pod-접속>8. pod 접속</a></li><li><a href=#9-포드-삭제>9. 포드 삭제</a></li></ul></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=개요 class="relative group">개요 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b0%9c%ec%9a%94 aria-label=Anchor>#</a></span></h1><p>macOS 로컬환경에서 Kubernetes 실습을 할 수 있도록 쿠버네티스 설치 과정을 설명한다.</p><br><h1 id=환경 class="relative group">환경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h1><ul><li><strong>Hardware</strong> : MacBook Pro (13", M1, 2020)</li><li><strong>OS</strong> : macOS Monterey 12.0.1</li><li><strong>패키지 관리자</strong> : Homebrew 3.3.2</li><li><strong>Docker Desktop 4.1.1</strong> + <strong>Kubernetes v1.21.5</strong></li></ul><br><h1 id=절차 class="relative group">절차 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a0%88%ec%b0%a8 aria-label=Anchor>#</a></span></h1><h3 id=1-docker-설치 class="relative group">1. Docker 설치 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-docker-%ec%84%a4%ec%b9%98 aria-label=Anchor>#</a></span></h3><p>macOS용 패키지 관리자인 Homebrew를 이용해 <code>docker</code>를 설치한다. 쿠버네티스를 사용하기 위해서는 docker를 먼저 설치해야한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ brew install --cask <span class=nv>docker</span>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Downloading https://desktop.docker.com/mac/main/arm64/69879/Docker.dmg
</span></span><span class=line><span class=cl>Already downloaded: /Users/ive/Library/Caches/Homebrew/downloads/b5774f18ca8a6d3936c5174f91b93cb1a1a407daa784fe63d9b6300180c7b1ed--Docker.dmg
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Installing Cask <span class=nv>docker</span>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Moving App <span class=s1>&#39;Docker.app&#39;</span> to <span class=s1>&#39;/Applications/Docker.app&#39;</span>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Linking Binary <span class=s1>&#39;docker-compose.bash-completion&#39;</span> to <span class=s1>&#39;/opt/homebrew/etc/bash_c
</span></span></span><span class=line><span class=cl><span class=s1>==&gt; Linking Binary &#39;</span>docker.zsh-completion<span class=s1>&#39; to &#39;</span>/opt/homebrew/share/zsh/site-func
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Linking Binary <span class=s1>&#39;docker.fish-completion&#39;</span> to <span class=s1>&#39;/opt/homebrew/share/fish/vendor_
</span></span></span><span class=line><span class=cl><span class=s1>==&gt; Linking Binary &#39;</span>docker-compose.fish-completion<span class=s1>&#39; to &#39;</span>/opt/homebrew/share/fish
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Linking Binary <span class=s1>&#39;docker-compose.zsh-completion&#39;</span> to <span class=s1>&#39;/opt/homebrew/share/zsh/s
</span></span></span><span class=line><span class=cl><span class=s1>==&gt; Linking Binary &#39;</span>docker.bash-completion<span class=s1>&#39; to &#39;</span>/opt/homebrew/etc/bash_completio
</span></span><span class=line><span class=cl>🍺  docker was successfully installed!
</span></span></code></pre></div><p>docker 최초 설치시 오래걸리니 인내심을 갖고 기다린다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ brew list --cask
</span></span><span class=line><span class=cl>docker                                   iterm2
</span></span></code></pre></div><p>cask 목록에 docker가 설치되었다.</p><br><p>런치패드에도 Docker 아이콘이 생성됐다.</p><p><figure><img class="my-0 rounded-md" src=./0.png alt="런치패드의 도커 아이콘"></figure></p><br><h3 id=2-kubernetes-활성화 class="relative group">2. kubernetes 활성화 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-kubernetes-%ed%99%9c%ec%84%b1%ed%99%94 aria-label=Anchor>#</a></span></h3><p>도커가 정상 설치되었다면 상단바에 Docker Desktop 아이콘이 나타난다.</p><p><figure><img class="my-0 rounded-md" src=./1.png alt="도커 환경설정"></figure></p><ul><li>상단바 Docker 아이콘 클릭 → 환경설정(Preferences) 클릭</li></ul><p><figure><img class="my-0 rounded-md" src=./2.png alt="쿠버네티스 활성화하기"></figure></p><ul><li>Kubernetes → Enable Kubernetes 체크 → Apply & Restart</li></ul><br><h3 id=3-kubernetes-상태-확인 class="relative group">3. kubernetes 상태 확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-kubernetes-%ec%83%81%ed%83%9c-%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p><strong>클러스터 정보 확인</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl cluster-info
</span></span><span class=line><span class=cl>Kubernetes control plane is running at https://kubernetes.docker.internal:6443
</span></span><span class=line><span class=cl>CoreDNS is running at https://kubernetes.docker.internal:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>To further debug and diagnose cluster problems, use <span class=s1>&#39;kubectl cluster-info dump&#39;</span>.
</span></span></code></pre></div><br><p><strong>kubectl 버전 확인</strong></p><p>kubectl은 쿠버네티스 클러스터를 제어하기 위한 커맨드 라인 도구이다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl version
</span></span><span class=line><span class=cl>Client Version: version.Info<span class=o>{</span>Major:<span class=s2>&#34;1&#34;</span>, Minor:<span class=s2>&#34;22&#34;</span>, GitVersion:<span class=s2>&#34;v1.22.3&#34;</span>, GitCommit:<span class=s2>&#34;c92036820499fedefec0f847e2054d824aea6cd1&#34;</span>, GitTreeState:<span class=s2>&#34;clean&#34;</span>, BuildDate:<span class=s2>&#34;2021-10-27T18:34:20Z&#34;</span>, GoVersion:<span class=s2>&#34;go1.16.10&#34;</span>, Compiler:<span class=s2>&#34;gc&#34;</span>, Platform:<span class=s2>&#34;darwin/arm64&#34;</span><span class=o>}</span>
</span></span><span class=line><span class=cl>Server Version: version.Info<span class=o>{</span>Major:<span class=s2>&#34;1&#34;</span>, Minor:<span class=s2>&#34;21&#34;</span>, GitVersion:<span class=s2>&#34;v1.21.5&#34;</span>, GitCommit:<span class=s2>&#34;aea7bbadd2fc0cd689de94a54e5b7b758869d691&#34;</span>, GitTreeState:<span class=s2>&#34;clean&#34;</span>, BuildDate:<span class=s2>&#34;2021-09-15T21:04:16Z&#34;</span>, GoVersion:<span class=s2>&#34;go1.16.8&#34;</span>, Compiler:<span class=s2>&#34;gc&#34;</span>, Platform:<span class=s2>&#34;linux/arm64&#34;</span><span class=o>}</span>
</span></span></code></pre></div><br><h3 id=4-pod-스펙-작성 class="relative group">4. pod 스펙 작성 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-pod-%ec%8a%a4%ed%8e%99-%ec%9e%91%ec%84%b1 aria-label=Anchor>#</a></span></h3><p>kubernetes에서 오브젝트를 생성하려면 오브젝트에 대한 기본적인 정보와 함께 의도한 상태를 기술한 오브젝트 스펙(spec)을 제시해야한다.</p><p>오브젝트를 생성하기 위한 작성 포맷은 YAML 혹은 JSON을 사용한다. 일반적으로 YAML이 다른 포맷보다 가독성이 좋고 작성도 편해 많이들 사용한다.</p><p>쿠버네티스 구성요소의 최소 단위는 포드(Pod)이다. 1개의 pod는 1개 이상의 컨테이너로 구성된다.</p><p>아래는 pod를 배포하는 간단한 yaml 샘플 코드이다. vi 에디터를 이용해 그대로 작성해 저장한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>$ cat sample-pod.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>myapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp-container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;sh&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;-c&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;echo Hello Kubernetes! &amp;&amp; sleep 3600&#39;</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></div><br><h3 id=5-pod-배포 class="relative group">5. pod 배포 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-pod-%eb%b0%b0%ed%8f%ac aria-label=Anchor>#</a></span></h3><p>작성한 포드 스펙(<code>sample-pod.yaml</code>)을 적용한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl apply -f sample-pod.yaml
</span></span><span class=line><span class=cl>pod/myapp-pod created
</span></span></code></pre></div><p>실행 결과로 <code>pod/myapp-pod created</code> 메세지가 출력되면 pod가 정상 생성된 것이다.</p><br><h3 id=6-pod-상태확인 class="relative group">6. pod 상태확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#6-pod-%ec%83%81%ed%83%9c%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><p><strong>포드 정보를 간단히 출력</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods
</span></span><span class=line><span class=cl>NAME        READY   STATUS              RESTARTS   AGE
</span></span><span class=line><span class=cl>myapp-pod   0/1     ContainerCreating   <span class=m>0</span>          3s
</span></span></code></pre></div><p>pod의 컨테이너가 생성중(<code>ContainerCreating</code>)인 상태다.</p><br><p>몇 초 후에 pod 상태를 다시 조회해본다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods
</span></span><span class=line><span class=cl>NAME        READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>myapp-pod   1/1     Running   <span class=m>0</span>          5s
</span></span></code></pre></div><p>현재는 pod에 컨테이너가 생성된 후 실행중(<code>Running</code>)이다.</p><br><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get po
</span></span></code></pre></div><p><code>pods</code> 키워드의 축약형인 <code>po</code>로 입력해도 된다. (pods 말고 다른 오브젝트들도 모두 축약형이 존재한다. deployments는 <code>deploy</code>, replicasets는 <code>rs</code>이다.)</p><p>CLI 환경에서는 한 글자라도 덜 치는게 고효율로 가는 지름길이다.</p><br><p><strong>포드 정보 자세히 출력</strong></p><p><code>kubectl get pod</code> 명령어 뒤에 <code>-o wide</code> 옵션을 붙이면 <code>IP</code>, <code>NODE</code>, <code>NOMINATED NODE</code>, <code>READINESS GATES</code> 4가지 정보를 더 보여준다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get pods -o wide
</span></span><span class=line><span class=cl>NAME        READY   STATUS    RESTARTS   AGE   IP         NODE             NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>myapp-pod   1/1     Running   <span class=m>0</span>          11s   10.1.0.8   docker-desktop   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><br><h3 id=7-배포-결과확인 class="relative group">7. 배포 결과확인 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#7-%eb%b0%b0%ed%8f%ac-%ea%b2%b0%ea%b3%bc%ed%99%95%ec%9d%b8 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl logs pod/myapp-pod
</span></span><span class=line><span class=cl>Hello Kubernetes!
</span></span></code></pre></div><p>특정 pod의 로그를 확인한다. <code>sample-pod.yaml</code> 파일에 작성한대로 pod가 <code>echo Hello Kubernetes!</code>를 실행했다.</p><br><h3 id=8-pod-접속 class="relative group">8. pod 접속 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#8-pod-%ec%a0%91%ec%86%8d aria-label=Anchor>#</a></span></h3><p><code>myapp-pod</code>의 <code>myapp-container</code> 안으로 shell 접속을 시도해본다.</p><br><p>옛날 버전의 kubernetes에서는 pod 접속시 <code>kubectl exec -it [POD] [COMMAND]</code> 명령어를 사용했었다. 하지만 해당 명령어는 신규 명령어로 대체(depreacted) 되어 곧 다음 버전에서 사라질 예정이다. 명령어 사용에 주의한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> -it myapp-pod /bin/sh -c myapp-container
</span></span><span class=line><span class=cl>kubectl <span class=nb>exec</span> <span class=o>[</span>POD<span class=o>]</span> <span class=o>[</span>COMMAND<span class=o>]</span> is DEPRECATED and will be removed in a future version. Use kubectl <span class=nb>exec</span> <span class=o>[</span>POD<span class=o>]</span> -- <span class=o>[</span>COMMAND<span class=o>]</span> instead.
</span></span></code></pre></div><br><p><strong>명령어 형식</strong></p><p>kubernetes 권고사항에 따라 아래의 신규 <code>kubectl exec</code> 명령어를 사용하도록 하자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> &lt;POD_NAME&gt; -c &lt;CONTAINER_NAME&gt; -it -- &lt;COMMAND&gt;
</span></span></code></pre></div><br><p><strong>실제 명령어</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> myapp-pod -c myapp-container -it -- /bin/sh
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl <span class=nb>exec</span> myapp-pod -c myapp-container -it -- /bin/sh
</span></span><span class=line><span class=cl><span class=c1># --- 여기서부터는 컨테이너의 shell 환경에 진입한 상태이다. ---</span>
</span></span><span class=line><span class=cl>/ <span class=c1># hostname</span>
</span></span><span class=line><span class=cl>myapp-pod
</span></span><span class=line><span class=cl>/ <span class=c1># ifconfig</span>
</span></span><span class=line><span class=cl>eth0      Link encap:Ethernet  HWaddr 5E:DC:25:DF:28:AA
</span></span><span class=line><span class=cl>          inet addr:10.1.0.9  Bcast:10.1.255.255  Mask:255.255.0.0
</span></span><span class=line><span class=cl>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span></span><span class=line><span class=cl>          RX packets:14 errors:0 dropped:0 overruns:0 frame:0
</span></span><span class=line><span class=cl>          TX packets:1 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span class=line><span class=cl>          collisions:0 txqueuelen:0
</span></span><span class=line><span class=cl>          RX bytes:1048 <span class=o>(</span>1.0 KiB<span class=o>)</span>  TX bytes:42 <span class=o>(</span>42.0 B<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>lo        Link encap:Local Loopback
</span></span><span class=line><span class=cl>          inet addr:127.0.0.1  Mask:255.0.0.0
</span></span><span class=line><span class=cl>          UP LOOPBACK RUNNING  MTU:65536  Metric:1
</span></span><span class=line><span class=cl>          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
</span></span><span class=line><span class=cl>          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
</span></span><span class=line><span class=cl>          collisions:0 txqueuelen:1000
</span></span><span class=line><span class=cl>          RX bytes:0 <span class=o>(</span>0.0 B<span class=o>)</span>  TX bytes:0 <span class=o>(</span>0.0 B<span class=o>)</span>
</span></span></code></pre></div><p>컨테이너 상태 확인이 끝났다면 <code>Ctrl</code> + <code>p</code>, <code>q</code> 키(Escape Sequence)를 입력해서 container의 shell에서 빠져나온다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>exec</span> attach failed: error on attach stdin: <span class=nb>read</span> escape sequence
</span></span><span class=line><span class=cl><span class=nb>command</span> terminated with <span class=nb>exit</span> code <span class=m>126</span>
</span></span><span class=line><span class=cl>$ 
</span></span></code></pre></div><br><h3 id=9-포드-삭제 class="relative group">9. 포드 삭제 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#9-%ed%8f%ac%eb%93%9c-%ec%82%ad%ec%a0%9c aria-label=Anchor>#</a></span></h3><p>학습이 끝났으니 생성된 pod를 삭제하고 정리하자.</p><p><code>kubectl delete pod</code> 명령어를 이용해 포드를 지정해 삭제를 할수도 있지만, 깔끔한 삭제를 위해서는 <code>-f</code> 옵션을 이용해 yaml 파일에 선언된 설정을 기반으로 삭제하는 걸 권장한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl delete -f sample-pod.yaml
</span></span><span class=line><span class=cl>pod <span class=s2>&#34;myapp-pod&#34;</span> deleted
</span></span></code></pre></div><p>삭제 소요시간은 약 20초 걸린다. 설정파일에 선언된 <code>myapp-pod</code> 포드가 정상 삭제됐다.</p><br><p>정말로 포드가 삭제되었는지 확인해보자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get po
</span></span><span class=line><span class=cl>No resources found in default namespace.
</span></span></code></pre></div><p>아무런 포드도 조회되지 않는다. 잘 삭제되었다. 끝!</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>