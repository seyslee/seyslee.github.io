<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>쿠버네티스의 도커 지원 중단 &#183; seyslee</title><meta name=title content="쿠버네티스의 도커 지원 중단 &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/k8s/kubernetes-is-deprecating-docker/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fff8ff4cdbe2bf80930c53b6e47a6d9826b914a8623246481ff09ff52ea48fcfb403d9ba1dc7bbc800a7ecb15298c468838a661dd8ebb3e9f46fdca239b38a30.css integrity="sha512-//j/TNviv4CTDFO25HptmCa5FKhiMkZIH/Cf9S6kj8+0A9m6Hce7yACn7LFSmMRog4pmHdjrs+n0b9yiObOKMA=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="쿠버네티스의 도커 지원 중단"><meta property="og:description" content="쿠버네티스는 v1.20 이후 컨테이너 런타임으로서 dockershim 사용을 중단하기로 결정했습니다. 이 이벤트가 발생한 이유, 배경, 영향을 설명합니다."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/k8s/kubernetes-is-deprecating-docker/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2021-11-16T22:58:05+09:00"><meta property="article:modified_time" content="2021-11-17T07:46:20+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="쿠버네티스의 도커 지원 중단"><meta name=twitter:description content="쿠버네티스는 v1.20 이후 컨테이너 런타임으로서 dockershim 사용을 중단하기로 결정했습니다. 이 이벤트가 발생한 이유, 배경, 영향을 설명합니다."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"쿠버네티스의 도커 지원 중단","headline":"쿠버네티스의 도커 지원 중단","description":"쿠버네티스는 v1.20 이후 컨테이너 런타임으로서 dockershim 사용을 중단하기로 결정했습니다. 이 이벤트가 발생한 이유, 배경, 영향을 설명합니다.","abstract":"발단 # 컨테이너를 관리하는 프로그램을 컨테이너 런타임(Container Runtime)이라고 부른다.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/k8s\/kubernetes-is-deprecating-docker\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2021","dateCreated":"2021-11-16T22:58:05\u002b09:00","datePublished":"2021-11-16T22:58:05\u002b09:00","dateModified":"2021-11-17T07:46:20\u002b09:00","keywords":["devops","kubernetes"],"mainEntityOfPage":"true","wordCount":"302"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">쿠버네티스의 도커 지원 중단</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2021-11-16 22:58:05 +0900 +0900">Nov 16, 2021</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#발단>발단</a></li><li><a href=#변경사항>변경사항</a></li><li><a href=#이유>이유</a></li><li><a href=#영향해결책>영향/해결책</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=발단 class="relative group">발단 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%b0%9c%eb%8b%a8 aria-label=Anchor>#</a></span></h1><p>컨테이너를 관리하는 프로그램을 컨테이너 런타임(Container Runtime)이라고 부른다.</p><p>쿠버네티스는 v1.20 이후 컨테이너 런타임으로서 도커 사용을 중단(deprecating)하기로 결정했다. 쿠버네티스 v1.20 버전부터는 dockershim이 지원 중단되었다(<code>deprecated</code>)는 경고 메세지가 출력된다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Using dockershim is deprecated, please consider using a full-fledged CRI implementation
</span></span></code></pre></div><p>이 말은 도커에 내장된 컨테이너 런타임인 dockershim이 곧 삭제 된다는 의미이다. dockershim의 삭제 시점은 쿠버네티스 v1.24 버전에 예정되어 있다.</p><p>쿠버네티스 공식 블로그 포스팅에는 &ldquo;당황하지 마라. 생각보다 극적이지 않다.(You do not need to panic. It’s not as dramatic as it sounds.)&rdquo; 라고 적혀있다.</p><br><h1 id=변경사항 class="relative group">변경사항 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%b3%80%ea%b2%bd%ec%82%ac%ed%95%ad aria-label=Anchor>#</a></span></h1><p>kubelet과 docker 사이에 위치한 dockershim이 사라진다.</p><br><p><strong>kubelet 아키텍쳐 비교</strong></p><p><figure><img class="my-0 rounded-md" src=./1.png alt="dockershim이 사라지기 전후 아키텍쳐 비교"></figure></p><p>kubelet에서 컨테이너 런타임으로 docker를 사용할 경우 containerd와 직접 통신한다. 아키텍쳐가 더 간결해지고 성능이 향상된다.</p><br><p><strong>파드 시작시 지연시간 비교</strong></p><p><figure><img class="my-0 rounded-md" src=./2.png alt></figure></p><p>위 그래프는 파드가 시작될 때의 지연시간이다. (낮을수록 좋음) dockershim을 이용할 때보다 Containerd를 이용할 때 파드 시작속도가 훨씬 빠른 걸 알 수 있다.</p><br><h1 id=이유 class="relative group">이유 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%9d%b4%ec%9c%a0 aria-label=Anchor>#</a></span></h1><ol><li><strong>방치</strong> : 개발사인 도커는 도커에 내장된 컨테이너 런타임인 dockershim을 2019년 3월 이후로 2년 넘게 업데이트 없이 방치했다. 쿠버네티스는 1년간 도커를 기다려주던 중 지원 중단 선언을 한 것이다.</li><li><strong>호환성</strong> : 쿠버네티스는 CRI(Container Runtime Interface) 표준을 사용해 컨테이너 런타임과 통신한다. 그러나 docker는 CRI 표준을 지키지 않고 별도로 dockershim을 통해 변환을 거쳐 도커 전용 인터페이스로 변환해 사용해왔다. dockershim으로 인해 생긴 불필요하고 복잡한 구조 때문에 쿠버네티스 측에서 유지보수가 어려워졌다.</li></ol><br><h1 id=영향해결책 class="relative group">영향/해결책 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%98%81%ed%96%a5%ed%95%b4%ea%b2%b0%ec%b1%85 aria-label=Anchor>#</a></span></h1><p><strong>Kubernetes 시스템 관리자의 관점</strong></p><ul><li><strong>도커 이미지</strong> : 도커 이미지는 OCI(Open Container Initiative) 표준이기 때문에 계속해서 사용 가능하다. 조치가 필요한 사항은 없음.</li><li><strong>노드의 컨테이너 런타임</strong> : 마스터 노드와 워커 노드의 컨테이너 런타임을 dockershim에서 CRI를 지원하는 containerd나 CRI-O 중 하나를 선택해 변경하면 된다. 컨테이너 런타임을 containerd나 CRI-O로 변경하면 기존에 쓰던 <code>docker</code> 명령어는 사용할 수 없게 되니 참고하자.</li></ul><br><p><strong>컨테이너 런타임 설명</strong></p><p><strong>CRI-O</strong></p><p>레드햇, 인텔, SUSE, Hyper, IBM의 관리자와 컨트리뷰터들이 만든 커뮤니티 중심의 오픈소스 프로젝트이다. CRI-O는 container를 실행하는 역할만 담당하고 있다. (도커의 containerd와 동일한 역할) CRI-O는 image build, CLI, image registry 생성 등의 부가기능은 수행하지 못한다.</p><br><p><strong>containerd</strong></p><p>단순성, 견고성 및 이식성을 강조하는 산업 표준 컨테이너 런타임</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>