<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>ArgoCD on minikube &#183; seyslee</title><meta name=title content="ArgoCD on minikube &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/k8s/argocd-on-minikube/><link type=text/css rel=stylesheet href=/css/main.bundle.min.fff8ff4cdbe2bf80930c53b6e47a6d9826b914a8623246481ff09ff52ea48fcfb403d9ba1dc7bbc800a7ecb15298c468838a661dd8ebb3e9f46fdca239b38a30.css integrity="sha512-//j/TNviv4CTDFO25HptmCa5FKhiMkZIH/Cf9S6kj8+0A9m6Hce7yACn7LFSmMRog4pmHdjrs+n0b9yiObOKMA=="><script type=text/javascript src=/js/appearance.min.badab316c9287a5a42a843e4eb45da65bb3d194a5a0f5fa4a3e516160e67df0b8c65f4f19a8e146436e29d583699e6cb41d6bbe99e05e1dbaa877763bad9f8e2.js integrity="sha512-utqzFskoelpCqEPk60XaZbs9GUpaD1+ko+UWFg5n3wuMZfTxmo4UZDbinVg2mebLQda76Z4F4duqh3djutn44g=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="ArgoCD on minikube"><meta property="og:description" content="minikube í™˜ê²½ì—ì„œ ArgoCD ì„¤ì¹˜í•˜ê³  ìš´ì˜í•´ë³´ëŠ” ê°€ì´ë“œ ë¬¸ì„œ."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/k8s/argocd-on-minikube/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-07-06T23:56:40+09:00"><meta property="article:modified_time" content="2022-07-06T23:57:05+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="ArgoCD on minikube"><meta name=twitter:description content="minikube í™˜ê²½ì—ì„œ ArgoCD ì„¤ì¹˜í•˜ê³  ìš´ì˜í•´ë³´ëŠ” ê°€ì´ë“œ ë¬¸ì„œ."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"ArgoCD on minikube","headline":"ArgoCD on minikube","description":"minikube í™˜ê²½ì—ì„œ ArgoCD ì„¤ì¹˜í•˜ê³  ìš´ì˜í•´ë³´ëŠ” ê°€ì´ë“œ ë¬¸ì„œ.","abstract":"ê°œìš” # ArgoCDëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ëŒ€í‘œì ì¸ GitOps êµ¬í˜„ì²´ì…ë‹ˆë‹¤.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/k8s\/argocd-on-minikube\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2022","dateCreated":"2022-07-06T23:56:40\u002b09:00","datePublished":"2022-07-06T23:56:40\u002b09:00","dateModified":"2022-07-06T23:57:05\u002b09:00","keywords":["devops","kubernetes","minikube"],"mainEntityOfPage":"true","wordCount":"1175"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><nav class="flex justify-between"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><ul class="flex flex-col list-none ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">ArgoCD on minikube</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-07-06 23:56:40 +0900 +0900">Jul 6, 2022</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><ul><li><a href=#ê°œìš”>ê°œìš”</a></li><li><a href=#ì „ì œì¡°ê±´>ì „ì œì¡°ê±´</a></li><li><a href=#í™˜ê²½>í™˜ê²½</a></li><li><a href=#ì‹¤ìŠµí•˜ê¸°>ì‹¤ìŠµí•˜ê¸°</a><ul><li><a href=#1-minikube-í´ëŸ¬ìŠ¤í„°-ìƒì„±>1. minikube í´ëŸ¬ìŠ¤í„° ìƒì„±</a></li><li><a href=#2-argocd-ì„¤ì¹˜>2. ArgoCD ì„¤ì¹˜</a></li><li><a href=#3-argocd-ì›¹-ì ‘ì†>3. ArgoCD ì›¹ ì ‘ì†</a></li><li><a href=#4-application-ë°°í¬í•˜ê¸°>4. Application ë°°í¬í•˜ê¸°</a></li><li><a href=#5-selfheal-ê¸°ëŠ¥-í™œì„±í™”>5. selfHeal ê¸°ëŠ¥ í™œì„±í™”</a></li></ul></li><li><a href=#ì •ë¦¬í•˜ê¸°>ì •ë¦¬í•˜ê¸°</a></li><li><a href=#ë§ˆì¹˜ë©°>ë§ˆì¹˜ë©°</a></li></ul></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h2 id=ê°œìš” class="relative group">ê°œìš” <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b0%9c%ec%9a%94 aria-label=Anchor>#</a></span></h2><p>ArgoCDëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„°ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ëŒ€í‘œì ì¸ GitOps êµ¬í˜„ì²´ì…ë‹ˆë‹¤.</p><p>ì´ ê¸€ì€ minikube í´ëŸ¬ìŠ¤í„° í™˜ê²½ì— ArgoCDë¥¼ ì„¤ì¹˜í•˜ê³  ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•´ë³´ëŠ” ì¼ë ¨ì˜ ê³¼ì •ë“¤ì„ ì„¤ëª…í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p>Â </p><h2 id=ì „ì œì¡°ê±´ class="relative group">ì „ì œì¡°ê±´ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a0%84%ec%a0%9c%ec%a1%b0%ea%b1%b4 aria-label=Anchor>#</a></span></h2><ul><li>minikubeê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</li><li>docker desktopì´ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.</li></ul><p>macOSì˜ ê²½ìš° íŒ¨í‚¤ì§€ ê´€ë¦¬ìì¸ homebrewë¥¼ ì´ìš©í•´ minikubeì™€ docker dekstop ëª¨ë‘ ì‰½ê²Œ ì„¤ì¹˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>ë¬¼ë¡  ì´ ê¸€ì—ì„œ ê´€ë ¨ íŒ¨í‚¤ì§€ì˜ ì„¤ì¹˜ ê³¼ì •ê¹Œì§€ ì„¤ëª…í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.</p><p>Â </p><h2 id=í™˜ê²½ class="relative group">í™˜ê²½ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h2><ul><li><strong>OS</strong> : macOS Monterey 12.4 (M1 Pro)</li><li><strong>Shell</strong> : zsh + oh-my-zsh</li><li><strong>minikube</strong> v1.26.0 (brewë¡œ ì„¤ì¹˜í•¨)</li><li><strong>docker desktop</strong> v20.10.16 (brewë¡œ ì„¤ì¹˜í•¨)</li></ul><p>ì €í¬ê°€ êµ¬ì„±í•  ArgoCD ì•„í‚¤í…ì³ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./1.png alt=Architecture></figure></p><p>Â </p><h2 id=ì‹¤ìŠµí•˜ê¸° class="relative group">ì‹¤ìŠµí•˜ê¸° <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%8b%a4%ec%8a%b5%ed%95%98%ea%b8%b0 aria-label=Anchor>#</a></span></h2><h3 id=1-minikube-í´ëŸ¬ìŠ¤í„°-ìƒì„± class="relative group">1. minikube í´ëŸ¬ìŠ¤í„° ìƒì„± <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-minikube-%ed%81%b4%eb%9f%ac%ec%8a%a4%ed%84%b0-%ec%83%9d%ec%84%b1 aria-label=Anchor>#</a></span></h3><p><code>minikube</code> ëª…ë ¹ì–´ê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube version
</span></span><span class=line><span class=cl>minikube version: v1.26.0
</span></span><span class=line><span class=cl>commit: f4b412861bb746be73053c9f6d2895f12cf78565
</span></span></code></pre></div><p>Â </p><p>ë…¸ë“œ 3ëŒ€ë¡œ êµ¬ì„±ëœ minikube í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube start <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --driver<span class=o>=</span><span class=s1>&#39;docker&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --nodes<span class=o>=</span><span class=m>3</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --addons<span class=o>=</span><span class=s1>&#39;ingress&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --kubernetes-version<span class=o>=</span><span class=s1>&#39;stable&#39;</span>
</span></span></code></pre></div><p>minikube í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•  ë•Œ <code>--addons</code> ì˜µì…˜ì„ ì‚¬ìš©í•´ì„œ ingress addonsë¥¼ í™œì„±í™”í•´ì£¼ëŠ” ê²Œ ì¤‘ìš” í¬ì¸íŠ¸ì…ë‹ˆë‹¤.</p><p>Â </p><p><strong>Addon í™•ì¸</strong><br><code>ingress</code> ì• ë“œì˜¨ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube addons list
</span></span></code></pre></div><p>í˜„ì¬ <code>ingress</code> ì• ë“œì˜¨ì´ <code>enabled âœ…</code>ë¡œ í™œì„±í™”ëœ ìƒíƒœì…ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=p>|</span>-----------------------------<span class=p>|</span>----------<span class=p>|</span>--------------<span class=p>|</span>--------------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>         ADDON NAME          <span class=p>|</span> PROFILE  <span class=p>|</span>    STATUS    <span class=p>|</span>           MAINTAINER           <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------------------------<span class=p>|</span>----------<span class=p>|</span>--------------<span class=p>|</span>--------------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ...                         <span class=p>|</span> ...      <span class=p>|</span> ...          <span class=p>|</span> ...                            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ingress                     <span class=p>|</span> minikube <span class=p>|</span> enabled âœ…   <span class=p>|</span> 3rd party <span class=o>(</span>unknown<span class=o>)</span>            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> ...                         <span class=p>|</span> ...      <span class=p>|</span> ...          <span class=p>|</span> ...                            <span class=p>|</span>
</span></span></code></pre></div><p>Â </p><p><strong>Node í™•ì¸</strong><br>minikube í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ì„±í•˜ëŠ” ë…¸ë“œ ì •ë³´ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get node
</span></span><span class=line><span class=cl>NAME           STATUS   ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>minikube       Ready    control-plane   84m   v1.24.1
</span></span><span class=line><span class=cl>minikube-m02   Ready    &lt;none&gt;          82m   v1.24.1
</span></span><span class=line><span class=cl>minikube-m03   Ready    &lt;none&gt;          81m   v1.24.1
</span></span></code></pre></div><p>ì»¨íŠ¸ë¡¤ í”Œë ˆì¸ 1ëŒ€ì™€ ì›Œì»¤ë…¸ë“œ 2ëŒ€ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.<br>ëª¨ë“  ë…¸ë“œëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ <code>v1.24.1</code>ì„ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p>Â </p><h3 id=2-argocd-ì„¤ì¹˜ class="relative group">2. ArgoCD ì„¤ì¹˜ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-argocd-%ec%84%a4%ec%b9%98 aria-label=Anchor>#</a></span></h3><p><strong>ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±</strong><br><code>argocd</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl create namespace argocd
</span></span></code></pre></div><p>Â </p><h4 id=argocd-ë°°í¬ class="relative group">ArgoCD ë°°í¬ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#argocd-%eb%b0%b0%ed%8f%ac aria-label=Anchor>#</a></span></h4><p>ì´í›„ ArgoCD ì„¤ì¹˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ë‹¤ìš´ë¡œë“œ ë°›ëŠ” ë™ì‹œì— <code>apply</code>ë¡œ ë°°í¬í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl apply <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n argocd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml
</span></span></code></pre></div><p>stable ë²„ì „ì˜ ArgoCDë¥¼ ë°°í¬í•  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” ì €í¬ê°€ ë°©ê¸ˆ ë§Œë“  <code>argocd</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì…ë‹ˆë‹¤.</p><p>Â </p><h4 id=ë°°í¬-ê³¼ì •-ëª¨ë‹ˆí„°ë§ class="relative group">ë°°í¬ ê³¼ì • ëª¨ë‹ˆí„°ë§ <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%b0%b0%ed%8f%ac-%ea%b3%bc%ec%a0%95-%eb%aa%a8%eb%8b%88%ed%84%b0%eb%a7%81 aria-label=Anchor>#</a></span></h4><p>ArgoCD ì»´í¬ë„ŒíŠ¸ ì „ì²´ê°€ ì„¤ì¹˜ë˜ê¸° ê¹Œì§€ ìµœì†Œ 2ë¶„ ì´ìƒ ì†Œìš”ë©ë‹ˆë‹¤.<br>ArgoCDê°€ ì„¤ì¹˜ë˜ëŠ” ë™ì•ˆ <code>watch</code> ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•´ ArgoCD ê´€ë ¨ íŒŒë“œì˜ ìƒì„± ê³¼ì •ì„ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ watch -d -n1 <span class=s2>&#34;kubectl get all -n argocd&#34;</span>
</span></span></code></pre></div><p><strong>watch ëª…ë ¹ì–´ ì„¤ëª…</strong><br><code>-d</code> : ê°’ì´ ë³€í™”í•˜ë©´ í„°ë¯¸ë„ì— ìŒì˜ì²˜ë¦¬í•´ì„œ í‘œì‹œí•´ì£¼ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤.<br><code>-n1</code> : ëª¨ë‹ˆí„°ë§ì„ 1ì´ˆ ê°„ê²©ìœ¼ë¡œ ì§„í–‰í•œë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p><p>Â </p><p>argocd-server ì„œë¹„ìŠ¤ì˜ ê¸°ë³¸ íƒ€ì…ì€ <code>ClusterIP</code> ì…ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get service argocd-server -n argocd
</span></span><span class=line><span class=cl>NAME            TYPE        CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>          AGE
</span></span><span class=line><span class=cl>argocd-server   ClusterIP   10.102.205.163   &lt;none&gt;        80/TCP,443/TCP   2m59s
</span></span></code></pre></div><p>Â </p><h4 id=ì„œë¹„ìŠ¤-ì„¤ì • class="relative group">ì„œë¹„ìŠ¤ ì„¤ì • <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%84%9c%eb%b9%84%ec%8a%a4-%ec%84%a4%ec%a0%95 aria-label=Anchor>#</a></span></h4><p>ArgoCD ì„¤ì¹˜ê°€ ì™„ë£Œë˜ì—ˆìœ¼ë©´ ì´ì œ ArgoCD ì„œë¹„ìŠ¤ íƒ€ì…ì„ ê¸°ë³¸ê°’ì¸ <code>ClusterIP</code>ì—ì„œ <code>LoadBalancer</code>ë¡œ ë³€ê²½í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl patch svc argocd-server <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n argocd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p <span class=s1>&#39;{&#34;spec&#34;: {&#34;type&#34;: &#34;LoadBalancer&#34;}}&#39;</span>
</span></span><span class=line><span class=cl>service/argocd-server patched
</span></span></code></pre></div><p>Â </p><p>ì„œë¹„ìŠ¤ íƒ€ì…ì´ <code>ClusterIP</code>ì—ì„œ <code>LoadBalancer</code>ë¡œ ë³€ê²½ëœ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get service argocd-server -n argocd
</span></span><span class=line><span class=cl>NAME            TYPE           CLUSTER-IP       EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>                      AGE
</span></span><span class=line><span class=cl>argocd-server   LoadBalancer   10.102.205.163   &lt;pending&gt;     80:31129/TCP,443:32744/TCP   3m46s
</span></span></code></pre></div><p>Â </p><h3 id=3-argocd-ì›¹-ì ‘ì† class="relative group">3. ArgoCD ì›¹ ì ‘ì† <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-argocd-%ec%9b%b9-%ec%a0%91%ec%86%8d aria-label=Anchor>#</a></span></h3><p>minikubeì—ì„œ <code>arogcd</code> ì„œë¹„ìŠ¤ê°€ ì™¸ë¶€ì— ë…¸ì¶œëœ ìƒíƒœì¸ì§€ í™•ì¸í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube service list <span class=p>|</span> grep argocd
</span></span></code></pre></div><p>Â </p><p>minikube í´ëŸ¬ìŠ¤í„° ì•ˆì— ì„œë¹„ìŠ¤ë¡œ ì—°ê²°í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube service argocd-server -n argocd
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>---------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> NAMESPACE <span class=p>|</span>     NAME      <span class=p>|</span> TARGET PORT <span class=p>|</span>            URL            <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>---------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> argocd    <span class=p>|</span> argocd-server <span class=p>|</span> http/80     <span class=p>|</span> http://192.168.49.2:31129 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>           <span class=p>|</span>               <span class=p>|</span> https/443   <span class=p>|</span> http://192.168.49.2:32744 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>---------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl>ğŸƒ  argocd-server ì„œë¹„ìŠ¤ì˜ í„°ë„ì„ ì‹œì‘í•˜ëŠ” ì¤‘
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> NAMESPACE <span class=p>|</span>     NAME      <span class=p>|</span> TARGET PORT <span class=p>|</span>          URL           <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span> argocd    <span class=p>|</span> argocd-server <span class=p>|</span>             <span class=p>|</span> http://127.0.0.1:63319 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>           <span class=p>|</span>               <span class=p>|</span>             <span class=p>|</span> http://127.0.0.1:63320 <span class=p>|</span>
</span></span><span class=line><span class=cl><span class=p>|</span>-----------<span class=p>|</span>---------------<span class=p>|</span>-------------<span class=p>|</span>------------------------<span class=p>|</span>
</span></span><span class=line><span class=cl><span class=o>[</span>argocd argocd-server  http://127.0.0.1:63319
</span></span><span class=line><span class=cl>http://127.0.0.1:63320<span class=o>]</span>
</span></span><span class=line><span class=cl>â—  Because you are using a Docker driver on darwin, the terminal needs to be open to run it.
</span></span></code></pre></div><p>ìœ„ ëª…ë ¹ì–´ì—ì„œ <code>http://127.0.0.1:63320</code> ì£¼ì†Œë¥¼ ë³µì‚¬í•©ë‹ˆë‹¤.<br>ì°¸ê³ ë¡œ 127.0.0.1 ë’¤ì— ë¶™ëŠ” í¬íŠ¸ëŠ” ê°ì í™˜ê²½ë§ˆë‹¤ ë‹¤ë¦…ë‹ˆë‹¤.</p><p>ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ì—´ê³  í•´ë‹¹ ì£¼ì†Œë¡œ ì ‘ì†í•˜ë©´ ArgoCD ë¡œê·¸ì¸ í˜ì´ì§€ë¥¼ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./2.png alt="ArgoCD ë¡œê·¸ì¸ í™”ë©´"></figure></p><p>Â </p><p>Admin ê³„ì •ì˜ íŒ¨ìŠ¤ì›Œë“œëŠ” Secretì— ì•”í˜¸í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.<br>Secretì—ì„œ ë½‘ì•„ë‚¸ ArgoCDì˜ Admin íŒ¨ìŠ¤ì›Œë“œë¥¼ <code>ARGO_PASSWORD</code> í™˜ê²½ë³€ìˆ˜ì— ë³´ê´€í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nv>ARGO_PASSWORD</span><span class=o>=</span><span class=k>$(</span>kubectl get secret argocd-initial-admin-secret <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n argocd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&#34;{.data.password}&#34;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  base64 -d<span class=k>)</span>
</span></span></code></pre></div><p>Admin íŒ¨ìŠ¤ì›Œë“œë¥¼ í™•ì¸í•´ë´…ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ <span class=nb>echo</span> <span class=nv>$ARGO_PASSWORD</span>
</span></span><span class=line><span class=cl>cymW0qvyzHYuCIRN
</span></span></code></pre></div><p>íŒ¨ìŠ¤ì›Œë“œë„ ë§ˆì°¬ê°€ì§€ë¡œ ê°ì í™˜ê²½ë§ˆë‹¤ ë‹¤ë¥´ê²Œ ì¶œë ¥ë©ë‹ˆë‹¤.</p><p>Â </p><p>ì´ì œ ArgoCD ì›¹í˜ì´ì§€ì—ì„œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./3.png alt="ë¡œê·¸ì¸ ì •ë³´ ì…ë ¥"></figure></p><ul><li><strong>ID</strong> : admin</li><li><strong>Password</strong> : <code>echo $ARGO_PASSWORD</code>ì˜ ê²°ê³¼ê°’ ì…ë ¥</li></ul><p>Â </p><h3 id=4-application-ë°°í¬í•˜ê¸° class="relative group">4. Application ë°°í¬í•˜ê¸° <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-application-%eb%b0%b0%ed%8f%ac%ed%95%98%ea%b8%b0 aria-label=Anchor>#</a></span></h3><h4 id=application class="relative group">Application <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#application aria-label=Anchor>#</a></span></h4><p>ArgoCDëŠ” <code>Application</code>ì´ë¼ëŠ” ë‹¨ìœ„ì˜ ì»¤ìŠ¤í…€ ë¦¬ì†ŒìŠ¤ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.<br><code>Application</code> CRD<sup>Custom Resource Definition</sup>ëŠ” í™˜ê²½ì— ë°°í¬ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë‚˜íƒ€ë‚´ëŠ” Kubernetes ë¦¬ì†ŒìŠ¤ ê°œì²´ì…ë‹ˆë‹¤.<br>Applicationì€ ì‰½ê²Œ ë§í•´ì„œ ArgoCDê°€ ì°¸ì¡°í•˜ëŠ”(ì§€ì†ì ìœ¼ë¡œ ë°°í¬í•˜ë ¤ê³  í•˜ëŠ”) &ldquo;ê¹ƒí—ˆë¸Œ ì†ŒìŠ¤ ë ˆí¬ì§€í„°ë¦¬&rdquo; ëŒ€ìƒì´ë¼ê³  ì´í•´í•˜ë©´ ì‰½ìŠµë‹ˆë‹¤.</p><p>Â </p><h4 id=deploy-application class="relative group">Deploy application <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#deploy-application aria-label=Anchor>#</a></span></h4><p>ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>$ cat &lt;&lt; EOF &gt; ./bgd-application.yaml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>argoproj.io/v1alpha1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>bgd-application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>argocd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>destination</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>bgd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class=l>https://kubernetes.default.svc </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>project</span><span class=p>:</span><span class=w> </span><span class=l>default </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>source</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>apps/bgd/overlays/bgd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>repoURL</span><span class=p>:</span><span class=w> </span><span class=l>https://github.com/redhat-developer-demos/openshift-gitops-examples</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>targetRevision</span><span class=p>:</span><span class=w> </span><span class=l>minikube</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>syncPolicy</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>automated</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>prune</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>selfHeal</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>syncOptions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>CreateNamespace=true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>EOF</span><span class=w>
</span></span></span></code></pre></div><p>ì €í¬ê°€ ë°°í¬í•˜ë ¤ëŠ” ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ê¹ƒí—ˆë¸Œ ë ˆí¬ì§€í„°ë¦¬ ì£¼ì†ŒëŠ” <a href=https://github.com/redhat-developer-demos/openshift-gitops-examples>https://github.com/redhat-developer-demos/openshift-gitops-examples</a>ì…ë‹ˆë‹¤.<br><code>bgd</code>ëŠ” blue-green deploymentì˜ ì•½ìì…ë‹ˆë‹¤.</p><p>Â </p><p>ì‘ì„±í•œ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•´ì„œ ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•©ë‹ˆë‹¤.<br>ë§¤ë‹ˆí˜ìŠ¤íŠ¸ì— ì´ë¯¸ <code>namespace: argocd</code> ê°’ì´ í¬í•¨ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, ë°°í¬í•  ë•Œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ì§€ì • ì˜µì…˜ì¸ <code>-n</code>ì„ ìƒëµí•´ë„ ë©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl apply -f bgd-application.yaml
</span></span><span class=line><span class=cl>application.argoproj.io/bgd-application created
</span></span></code></pre></div><p>Â </p><p>ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì€ ê¸°ë³¸ì ìœ¼ë¡œ <code>bgd</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get all -n bgd
</span></span></code></pre></div><p>Â </p><p>ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì¡°ëŠ” í¬ê²Œ ë³´ë©´ Deploymentì™€ Serviceë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                       READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>pod/bgd-696c9d9497-mqwpz   1/1     Running   <span class=m>0</span>          2m19s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME          TYPE       CLUSTER-IP    EXTERNAL-IP   PORT<span class=o>(</span>S<span class=o>)</span>          AGE
</span></span><span class=line><span class=cl>service/bgd   NodePort   10.99.5.226   &lt;none&gt;        8080:32085/TCP   2m19s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                  READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>deployment.apps/bgd   1/1     <span class=m>1</span>            <span class=m>1</span>           2m19s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                             DESIRED   CURRENT   READY   AGE
</span></span><span class=line><span class=cl>replicaset.apps/bgd-696c9d9497   <span class=m>1</span>         <span class=m>1</span>         <span class=m>1</span>       2m19s
</span></span></code></pre></div><p>Â </p><p>ArgoCD ì›¹ì—ì„œ ë°ëª¨ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ êµ¬ì„±ì„ í™•ì¸í•©ë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./4.png alt="bgd argocd"></figure></p><p>Â </p><p>ArgoCDëŠ” ê° Applicationì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ ì‹œê°í™”í•´ì„œ ë³´ì—¬ì¤ë‹ˆë‹¤.<br>ì´ëŸ¬í•œ ì‹œê°í™” ê¸°ëŠ¥ ë•Œë¬¸ì— ë§ì€ ê¸°ì—…ë“¤ì´ ArgoCDë¥¼ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./5.png alt="application êµ¬ì„±"></figure></p><p>Â </p><p>ë°°í¬í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì›¹í˜ì´ì§€ì— ì ‘ì†í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube service bgd -n bgd
</span></span></code></pre></div><p>ê¸°ë³¸ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ë©´ì„œ ìë™ì ìœ¼ë¡œ ì„œë¹„ìŠ¤ë¥¼ í†µí•´ <code>bgd-application</code>ì˜ ì›¹í˜ì´ì§€ë¡œ ì ‘ì†ë©ë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./6.png alt="bgd website on blue"></figure></p><p>Â </p><h4 id=change-application class="relative group">Change application <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#change-application aria-label=Anchor>#</a></span></h4><p>ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì •ë³´ë¥¼ ë³€ê²½í•´ì„œ ì ìš©í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl patch deploy/bgd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n bgd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --type<span class=o>=</span><span class=s1>&#39;json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p<span class=o>=</span><span class=s1>&#39;[{&#34;op&#34;: &#34;replace&#34;, &#34;path&#34;: &#34;/spec/template/spec/containers/0/env/0/value&#34;, &#34;value&#34;:&#34;green&#34;}]&#39;</span>
</span></span><span class=line><span class=cl>deployment.apps/bgd patched
</span></span></code></pre></div><p>ì›¹í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì„œ í™•ì¸í•´ë³´ë©´ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³´ì´ë˜ ì›¹í˜ì´ì§€ê°€ ì´ˆë¡ìƒ‰ìœ¼ë¡œ ë³€ê²½ë˜ëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./7.png alt="bgd website on green"></figure></p><p>Â </p><p>ì´í›„ Deploymentì˜ ë°°í¬ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl rollout status deploy/bgd -n bgd
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Waiting <span class=k>for</span> deployment <span class=s2>&#34;bgd&#34;</span> rollout to finish: <span class=m>1</span> old replicas are pending termination...
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> deployment <span class=s2>&#34;bgd&#34;</span> rollout to finish: <span class=m>1</span> old replicas are pending termination...
</span></span><span class=line><span class=cl>deployment <span class=s2>&#34;bgd&#34;</span> successfully rolled out
</span></span></code></pre></div><p>Â </p><p>ë‹¤ì‹œ íŒŒë€ìƒ‰ìœ¼ë¡œ ë³€ê²½í•´ë´…ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl patch deploy/bgd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n bgd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --type<span class=o>=</span><span class=s1>&#39;json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p<span class=o>=</span><span class=s1>&#39;[{&#34;op&#34;: &#34;replace&#34;, &#34;path&#34;: &#34;/spec/template/spec/containers/0/env/0/value&#34;, &#34;value&#34;:&#34;blue&#34;}]&#39;</span>
</span></span><span class=line><span class=cl>deployment.apps/bgd patched
</span></span></code></pre></div><p>Â </p><h3 id=5-selfheal-ê¸°ëŠ¥-í™œì„±í™” class="relative group">5. selfHeal ê¸°ëŠ¥ í™œì„±í™” <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-selfheal-%ea%b8%b0%eb%8a%a5-%ed%99%9c%ec%84%b1%ed%99%94 aria-label=Anchor>#</a></span></h3><p><code>bgd-application</code>ì˜ selfHeal í”Œë˜ê·¸ë¥¼ <code>true</code>ë¡œ ì„¤ì •í•´ì„œ selfHeal ê¸°ëŠ¥ì„ í™œì„±í™”í•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl patch application/bgd-application <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n argocd <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --type<span class=o>=</span>merge <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -p<span class=o>=</span><span class=s1>&#39;{&#34;spec&#34;:{&#34;syncPolicy&#34;:{&#34;automated&#34;:{&#34;prune&#34;:true,&#34;selfHeal&#34;:true}}}}&#39;</span>
</span></span><span class=line><span class=cl>application.argoproj.io/bgd-application patched
</span></span></code></pre></div><p>Â </p><p>ArgoCD ì›¹í˜ì´ì§€ì—ì„œ Pruneê³¼ Self Heal ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤.</p><p><figure><img class="my-0 rounded-md" src=./8.png alt="App details button"></figure></p><p>Applicationì—ì„œ [APP DETAILS] ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.</p><p>Â </p><p><figure><img class="my-0 rounded-md" src=./9.png alt="Prune and self heal"></figure></p><p>bgd-applicationì—ì„œ Prune Resourcesì™€ Self Heal ê¸°ëŠ¥ ë‘˜ ë‹¤ í™œì„±í™”ë˜ì–´ ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><ul><li><strong>Prune Resources</strong> : ê¹ƒí—ˆë¸Œ ì†ŒìŠ¤ê°€ ì—…ë°ì´íŠ¸ë  ë•Œ ì´ì „ ì¿ ë²„ë„¤í‹°ìŠ¤ ë¦¬ì†ŒìŠ¤(êµì²´ëœ Pod, êµì²´ëœ ReplicaSet ë“±)ë¥¼ ìë™ìœ¼ë¡œ ì œê±°í•˜ëŠ” ì˜µì…˜ì…ë‹ˆë‹¤. ì•ˆì „ìƒì˜ ì´ìœ ë¡œ ArgoCDì˜ Prune Resource ê°’ì€ ê¸°ë³¸ì ìœ¼ë¡œ ë¹„í™œì„±í™”(<code>false</code>) ì„¤ì •ë˜ì–´ ìˆìŠµë‹ˆë‹¤.<br><a href=https://argo-cd.readthedocs.io/en/stable/user-guide/auto_sync/#automatic-pruning>ArgoCD ê³µì‹ë¬¸ì„œ</a></li><li><strong>Self Heal</strong> : <code>selfHeal</code> í”Œë˜ê·¸ë¥¼ <code>true</code>ë¡œ ì„¤ì •(í™œì„±í™”)í•˜ë©´ ArgoCDê°€ ì§€ì†ì ìœ¼ë¡œ git repositoryì˜ ì„¤ì •ê°’ê³¼ ìš´ì˜ í™˜ê²½ ê°’ì˜ ì‹±í¬ë¥¼ ë§ì¶¥ë‹ˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ 5ì´ˆë§ˆë‹¤ ê³„ì†í•´ì„œ syncë¥¼ ì‹œë„í•˜ê²Œ ë©ë‹ˆë‹¤. ì‹œë„í•˜ëŠ” ê°„ê²©ì€ <code>argocd-application-controller</code> deploymentì— ì„¤ì •ëœ <code>--self-heal-timeout-seconds</code> ê°’ì…ë‹ˆë‹¤.<br><a href=https://argo-cd.readthedocs.io/en/stable/user-guide/auto_sync/#automated-sync-semantics>ArgoCD ê³µì‹ë¬¸ì„œ</a></li></ul><p>Â </p><h2 id=ì •ë¦¬í•˜ê¸° class="relative group">ì •ë¦¬í•˜ê¸° <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a0%95%eb%a6%ac%ed%95%98%ea%b8%b0 aria-label=Anchor>#</a></span></h2><p>ì‹¤ìŠµí™˜ê²½ì„ ì •ë¦¬í•˜ê¸° ìœ„í•´ì„œ minikube í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ minikube delete
</span></span></code></pre></div><p>ê²°ê³¼ê°’ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ğŸ”¥  docker ì˜ <span class=s2>&#34;minikube&#34;</span> ë¥¼ ì‚­ì œí•˜ëŠ” ì¤‘ ...
</span></span><span class=line><span class=cl>ğŸ”¥  Deleting container <span class=s2>&#34;minikube&#34;</span> ...
</span></span><span class=line><span class=cl>ğŸ”¥  Deleting container <span class=s2>&#34;minikube-m02&#34;</span> ...
</span></span><span class=line><span class=cl>ğŸ”¥  Deleting container <span class=s2>&#34;minikube-m03&#34;</span> ...
</span></span><span class=line><span class=cl>ğŸ”¥  /Users/guest/.minikube/machines/minikube ì œê±° ì¤‘ ...
</span></span><span class=line><span class=cl>ğŸ”¥  /Users/guest/.minikube/machines/minikube-m02 ì œê±° ì¤‘ ...
</span></span><span class=line><span class=cl>ğŸ”¥  /Users/guest/.minikube/machines/minikube-m03 ì œê±° ì¤‘ ...
</span></span><span class=line><span class=cl>ğŸ’€  <span class=s2>&#34;minikube&#34;</span> í´ëŸ¬ìŠ¤í„° ê´€ë ¨ ì •ë³´ê°€ ëª¨ë‘ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤
</span></span></code></pre></div><p>3ëŒ€ì˜ minikube ë…¸ë“œê°€ ì‚­ì œëœ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>Â </p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ kubectl get node
</span></span><span class=line><span class=cl>The connection to the server localhost:8080 was refused - did you specify the right host or port?
</span></span></code></pre></div><p>ëª¨ë“  ë…¸ë“œê°€ ì‚¬ë¼ì§„ ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p><p>Â </p><h2 id=ë§ˆì¹˜ë©° class="relative group">ë§ˆì¹˜ë©° <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%a7%88%ec%b9%98%eb%a9%b0 aria-label=Anchor>#</a></span></h2><p>ì´ê²ƒìœ¼ë¡œ minikube í™˜ê²½ì˜ ArgoCD íŠœí† ë¦¬ì–¼ì„ ë§ˆì¹˜ê² ìŠµë‹ˆë‹¤.<br>í•´ë‹¹ ìë£ŒëŠ” Red Hat Developerì— ê²Œì‹œëœ <a href=https://redhat-scholars.github.io/argocd-tutorial/argocd-tutorial/01-setup.html>ArgoCD Tutorial</a>ì„ ê¸°ë°˜ìœ¼ë¡œ ì‘ì„±í–ˆìŠµë‹ˆë‹¤.</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>