<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=false><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><title>테라폼으로 EC2 Instance 생성하기 데모 &#183; seyslee</title><meta name=title content="테라폼으로 EC2 Instance 생성하기 데모 &#183; seyslee"><meta name=description content="seyslee"><link rel=canonical href=https://seyslee.github.io/blog/terraform-demo/><link type=text/css rel=stylesheet href=/css/main.bundle.min.980311a18ad0b55ec626a015b02d8161dc5f9d2c385a9806100e43c16f86e2fd1b824521ff0017c49f7a84d11834247d5741e87d58473a289ef870e9f3d13c02.css integrity="sha512-mAMRoYrQtV7GJqAVsC2BYdxfnSw4WpgGEA5DwW+G4v0bgkUh/wAXxJ96hNEYNCR9V0HofVhHOiie+HDp89E8Ag=="><script type=text/javascript src=/js/appearance.min.12e98742cd283574d030a7fe55f29597df4ee214f7ff7075b4d19a64d046a602753c715295550be7899b661619cec89c679049d36c624681671a8013c1249896.js integrity="sha512-EumHQs0oNXTQMKf+VfKVl99O4hT3/3B1tNGaZNBGpgJ1PHFSlVUL54mbZhYZzsicZ5BJ02xiRoFnGoATwSSYlg=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9ae0a991bb442898e9bc60cf318b4de3ff878325ff3821625a5564b32b2f66aec0e7f7d0e00ca3ac7df59d9f01c18c88b6bdd213184f86ac9ce06d7bdffbadf8.js integrity="sha512-muCpkbtEKJjpvGDPMYtN4/+HgyX/OCFiWlVksysvZq7A5/fQ4AyjrH31nZ8BwYyItr3SExhPhqyc4G173/ut+A==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="테라폼으로 EC2 Instance 생성하기 데모"><meta property="og:description" content="테라폼을 이용해서 인프라 자동화를 구현해보자. 이 데모를 통해 서울 리전에 EC2 Instance 배포 후 삭제를 직접 진행한다."><meta property="og:type" content="article"><meta property="og:url" content="https://seyslee.github.io/blog/terraform-demo/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-02-22T01:34:00+09:00"><meta property="article:modified_time" content="2022-02-22T01:34:00+09:00"><meta property="og:site_name" content="seyslee"><meta name=twitter:card content="summary"><meta name=twitter:title content="테라폼으로 EC2 Instance 생성하기 데모"><meta name=twitter:description content="테라폼을 이용해서 인프라 자동화를 구현해보자. 이 데모를 통해 서울 리전에 EC2 Instance 배포 후 삭제를 직접 진행한다."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Blogs","name":"테라폼으로 EC2 Instance 생성하기 데모","headline":"테라폼으로 EC2 Instance 생성하기 데모","description":"테라폼을 이용해서 인프라 자동화를 구현해보자. 이 데모를 통해 서울 리전에 EC2 Instance 배포 후 삭제를 직접 진행한다.","abstract":"개요 # 테라폼을 통해 인프라 자동화, 코드로서 인프라IaC, Infrastructure as Code를 맛보기로 체험해보자.","inLanguage":"en","url":"https:\/\/seyslee.github.io\/blog\/terraform-demo\/","author":{"@type":"Person","name":"Younsung Lee"},"copyrightYear":"2022","dateCreated":"2022-02-22T01:34:00\u002b09:00","datePublished":"2022-02-22T01:34:00\u002b09:00","dateModified":"2022-02-22T01:34:00\u002b09:00","keywords":["devops","iac","terraform"],"mainEntityOfPage":"true","wordCount":"1708"}]</script><meta name=author content="Younsung Lee"><link href=mailto:ivecloudblack@gmail.com rel=me><link href=https://github.com/seyslee rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 bg-neutral text-neutral-900 sm:px-14 md:px-24 lg:px-32 dark:bg-neutral-800 dark:text-neutral max-w-7xl"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 dark:bg-neutral-600 focus:translate-y-0" href=#main-content><span class="font-bold ltr:pr-2 rtl:pl-2 text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="flex justify-between py-6 font-semibold sm:items-center sm:py-10 text-neutral-900 dark:text-neutral print:hidden"><div><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>seyslee</a></div><nav><ul class="flex flex-col list-none sm:flex-row"><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/blog/ title=Blogs>post</a></li><li class="mb-1 ltr:text-right rtl:text-left sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>tag</a></li></ul></nav></header><div class=relative><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">테라폼으로 EC2 Instance 생성하기 데모</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2022-02-22 01:34:00 +0900 +0900">Feb 22, 2022</time></div></div></header><section class="flex flex-col max-w-full mt-0 prose lg:flex-row dark:prose-invert"><div class="order-first px-0 lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8 lg:order-last"><div class="ltr:pl-5 rtl:pr-5 toc lg:sticky lg:top-10 print:hidden"><details open class="mt-0 overflow-hidden rounded-lg rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 lg:mt-3"><summary class="block py-1 text-lg font-semibold cursor-pointer rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 text-neutral-800 dark:text-neutral-100 lg:hidden bg-neutral-100 dark:bg-neutral-700">Table of Contents</summary><div class="py-2 border-dotted ltr:border-l rtl:border-r rtl:pr-5 ltr:pl-5 ltr:-ml-5 rtl:-mr-5 border-neutral-300 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#개요>개요</a></li><li><a href=#배경지식>배경지식</a></li><li><a href=#전제조건>전제조건</a></li><li><a href=#환경>환경</a></li><li><a href=#방법>방법</a><ul><li><ul><li><a href=#1-테라폼-설치>1. 테라폼 설치</a></li><li><a href=#2-테라폼-계정-생성>2. 테라폼 계정 생성</a></li><li><a href=#3-테라폼-파일-작성>3. 테라폼 파일 작성</a></li><li><a href=#4-테라폼-초기화>4. 테라폼 초기화</a></li><li><a href=#5-테라폼-적용>5. 테라폼 적용</a></li><li><a href=#6-삭제>6. 삭제</a></li></ul></li></ul></li><li><a href=#결론>결론</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose"><h1 id=개요 class="relative group">개요 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b0%9c%ec%9a%94 aria-label=Anchor>#</a></span></h1><p>테라폼을 통해 인프라 자동화, 코드로서 인프라<sup>IaC, Infrastructure as Code</sup>를 맛보기로 체험해보자.<br>테라폼 파일을 적용해서 1대의 EC2 Instance를 자동 생성하고 삭제해본다.</p><br><h1 id=배경지식 class="relative group">배경지식 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%b0%b0%ea%b2%bd%ec%a7%80%ec%8b%9d aria-label=Anchor>#</a></span></h1><p><strong>테라폼<sup>Terraform</sup></strong><br>하시코프<sup>Hashicorp</sup>에서 오픈소스로 개발중인 클라우드 인프라스트럭처 자동화를 지향하는 코드로서의 인프라스트럭처<sup>Infrastructure as Code, IaC</sup> 도구이다.</p><p>IaC는 코드로 인프라스트럭처를 관리한다는 개념으로 테라폼에서는 하시코프 설정 언어<sup>HCL, Hashicorp Configuration Language</sup>을 사용해 클라우드 리소스를 선언한다.</p><br><h1 id=전제조건 class="relative group">전제조건 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ec%a0%84%ec%a0%9c%ec%a1%b0%ea%b1%b4 aria-label=Anchor>#</a></span></h1><p>macOS용 패키지 관리자인 Homebrew가 미리 설치되어 있어야 한다.</p><p><a href=https://brew.sh/index_ko>Homebrew 설치방법</a></p><br><h1 id=환경 class="relative group">환경 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ed%99%98%ea%b2%bd aria-label=Anchor>#</a></span></h1><ul><li><strong>Hardware</strong> : MacBook Pro 13", M1, 2020</li><li><strong>OS</strong> : macOS Monterey 12.2.1</li><li><strong>Shell</strong> : zsh</li><li><strong>Terraform</strong> : v1.1.6</li><li><strong>Homebrew</strong> : 3.3.16</li></ul><br><h1 id=방법 class="relative group">방법 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%eb%b0%a9%eb%b2%95 aria-label=Anchor>#</a></span></h1><h3 id=1-테라폼-설치 class="relative group">1. 테라폼 설치 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#1-%ed%85%8c%eb%9d%bc%ed%8f%bc-%ec%84%a4%ec%b9%98 aria-label=Anchor>#</a></span></h3><p>macOS 패키지 관리자인 brew를 이용해 terraform을 설치한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ brew install <span class=nv>terraform</span>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Auto-updated Homebrew!
</span></span><span class=line><span class=cl>Updated <span class=m>1</span> tap <span class=o>(</span>homebrew/core<span class=o>)</span>.
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Updated Formulae
</span></span><span class=line><span class=cl>Updated <span class=m>2</span> formulae.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Downloading https://ghcr.io/v2/homebrew/core/terraform/manifests/1.1.6
</span></span><span class=line><span class=cl>Already downloaded: /Users/ive/Library/Caches/Homebrew/downloads/27878bff7eadcac8864a00be6ce343a4540476ed6fc8d7dfc576944971ebdf51--terraform-1.1.6.bottle_manifest.json
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Downloading https://ghcr.io/v2/homebrew/core/terraform/blobs/sha256:f6
</span></span><span class=line><span class=cl>Already downloaded: /Users/ive/Library/Caches/Homebrew/downloads/097e36e15ba08ef7554c666a971b9989a99e6a9ac84bcaf96b51ad43bed62804--terraform--1.1.6.arm64_monterey.bottle.tar.gz
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Pouring terraform--1.1.6.arm64_monterey.bottle.tar.gz
</span></span><span class=line><span class=cl>🍺  /opt/homebrew/Cellar/terraform/1.1.6: <span class=m>6</span> files, 69.5MB
</span></span><span class=line><span class=cl><span class=o>==</span>&gt; Running <span class=sb>`</span>brew cleanup terraform<span class=sb>`</span>...
</span></span><span class=line><span class=cl>Disable this behaviour by setting HOMEBREW_NO_INSTALL_CLEANUP.
</span></span><span class=line><span class=cl>Hide these hints with HOMEBREW_NO_ENV_HINTS <span class=o>(</span>see <span class=sb>`</span>man brew<span class=sb>`</span><span class=o>)</span>.
</span></span></code></pre></div><p><code>terraform</code> 명령어 동작상태를 확인한다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform version
</span></span><span class=line><span class=cl>Terraform v1.1.6
</span></span><span class=line><span class=cl>on darwin_arm64
</span></span></code></pre></div><p>arm64용 Terraform v1.1.6이 설치되었다.</p><br><h3 id=2-테라폼-계정-생성 class="relative group">2. 테라폼 계정 생성 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#2-%ed%85%8c%eb%9d%bc%ed%8f%bc-%ea%b3%84%ec%a0%95-%ec%83%9d%ec%84%b1 aria-label=Anchor>#</a></span></h3><p>AWS Management Console에 로그인 후 테라폼 전용 IAM 계정(User)을 생성한다.<figure><img class="my-0 rounded-md" src=./1.png alt></figure></p><p>Terraform을 이용해서 인스턴스를 생성하려면 Access Key와 Secrey Key가 필요하므로, 2개의 키 값을 반드시 메모해둔다.</p><br><h3 id=3-테라폼-파일-작성 class="relative group">3. 테라폼 파일 작성 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#3-%ed%85%8c%eb%9d%bc%ed%8f%bc-%ed%8c%8c%ec%9d%bc-%ec%9e%91%ec%84%b1 aria-label=Anchor>#</a></span></h3><p>terraform 파일을 2개 작성한다. 테라폼 파일의 확장자 이름은 <code>.tf</code> 이다.</p><pre tabindex=0><code>terraform-study
├── instance.tf
└── version.tf
</code></pre><ul><li><strong>instance.tf</strong> : 서울 리전<sup>ap-northeast-2</sup>에 1개의 EC2 Instance를 생성하는 파일.</li><li><strong>version.tf</strong> : 테라폼 버전과 클라우드 프로바이더 버전의 제한을 거는 파일.</li></ul><h4 id=instancetf class="relative group">instance.tf <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#instancetf aria-label=Anchor>#</a></span></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat instance.tf
</span></span><span class=line><span class=cl>provider <span class=s2>&#34;aws&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>access_key</span> <span class=o>=</span> <span class=s2>&#34;ACCESS_KEY_HERE&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>secret_key</span> <span class=o>=</span> <span class=s2>&#34;SECRET_KEY_HERE&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>region</span>     <span class=o>=</span> <span class=s2>&#34;ap-northeast-2&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>resource <span class=s2>&#34;aws_instance&#34;</span> <span class=s2>&#34;example&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>ami</span>           <span class=o>=</span> <span class=s2>&#34;ami-0dd97ebb907cf9366&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>instance_type</span> <span class=o>=</span> <span class=s2>&#34;t2.micro&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>IAM 유저를 새로 만들면서 발급된 <code>access_key</code>, <code>secret_key</code> 값을 넣어준다.</p><p><u><code>access_key</code>와 <code>secret_key</code> 값은 AWS 계정, 패스워드와 동일한 역할을 하기 때문에 절대 깃허브 레포지터리에 올려서도 안되고, 다른 사람들에게 공유해서도 안된다.</u> 만약 다른 사람이 해당 키 값들을 획득하면 AWS의 모든 권한을 탈취해서 전체 리전에 모든 리소스를 배포하는 사고가 발생해서 몇만 달러라는 거액을 청구받을 수도 있다. (구글링을 해보면 알겠지만 이런 사고가 생각보다 많이 발생한다.) <code>access_key</code>와 <code>secret_key</code> 키 값은 본인만 갖고 있자!</p><p>위 코드에서 <code>ami</code>는 AMI<sup>Amazon Machine Image</sup>의 ID를 의미하는 변수이다.</p><p><figure><img class="my-0 rounded-md" srcset="/blog/terraform-demo/2_huf1cd3e046b18d6f7995d281122005cdf_761595_330x0_resize_q75_box.jpg 330w,
/blog/terraform-demo/2_huf1cd3e046b18d6f7995d281122005cdf_761595_660x0_resize_q75_box.jpg 660w,
/blog/terraform-demo/2_huf1cd3e046b18d6f7995d281122005cdf_761595_1024x0_resize_q75_box.jpg 1024w,
/blog/terraform-demo/2_huf1cd3e046b18d6f7995d281122005cdf_761595_1320x0_resize_q75_box.jpg 2x" src=/blog/terraform-demo/2_huf1cd3e046b18d6f7995d281122005cdf_761595_660x0_resize_q75_box.jpg alt></figure></p><p>Ubuntu OS가 설치된 AMI<sup>Amazon Machine Image</sup> ID는 <a href=https://cloud-images.ubuntu.com/locator/ec2/>Amazon EC2 AMI Locator</a> 사이트에서 검색이 가능하다.</p><br><h4 id=versiontf class="relative group">version.tf <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#versiontf aria-label=Anchor>#</a></span></h4><p><code>version.tf</code> 파일은 테라폼 버전 0.12 이상에서만 해당 테라폼 코드가 실행되도록 제한하는 파일이다. 테라폼 버전과 프로바이더 버전에 따라서 테라폼 코드 실행결과가 다를 수가 있어서 일관된 결과를 얻기 위해 버전 제한을 걸었다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ cat versions.tf
</span></span><span class=line><span class=cl>terraform <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>required_version</span> <span class=o>=</span> <span class=s2>&#34;&gt;= 0.12&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><br><h3 id=4-테라폼-초기화 class="relative group">4. 테라폼 초기화 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#4-%ed%85%8c%eb%9d%bc%ed%8f%bc-%ec%b4%88%ea%b8%b0%ed%99%94 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform init
</span></span></code></pre></div><p><code>terraform init</code> 명령어를 실행하면 클라우드 제공자 플러그인<sup>Provier plugin</sup>을 찾는다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Initializing the backend...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Initializing provider plugins...
</span></span><span class=line><span class=cl>- Finding latest version of hashicorp/aws...
</span></span><span class=line><span class=cl>- Installing hashicorp/aws v4.2.0...
</span></span><span class=line><span class=cl>- Installed hashicorp/aws v4.2.0 <span class=o>(</span>signed by HashiCorp<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform has created a lock file .terraform.lock.hcl to record the provider
</span></span><span class=line><span class=cl>selections it made above. Include this file in your version control repository
</span></span><span class=line><span class=cl>so that Terraform can guarantee to make the same selections by default when
</span></span><span class=line><span class=cl>you run <span class=s2>&#34;terraform init&#34;</span> in the future.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform has been successfully initialized!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>You may now begin working with Terraform. Try running <span class=s2>&#34;terraform plan&#34;</span> to see
</span></span><span class=line><span class=cl>any changes that are required <span class=k>for</span> your infrastructure. All Terraform commands
</span></span><span class=line><span class=cl>should now work.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>If you ever <span class=nb>set</span> or change modules or backend configuration <span class=k>for</span> Terraform,
</span></span><span class=line><span class=cl>rerun this <span class=nb>command</span> to reinitialize your working directory. If you forget, other
</span></span></code></pre></div><p>terraform 초기화가 시작되면서 자동으로 최신 버전의 AWS 플러그인 v4.2.0이 설치되었다.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>- Installing hashicorp/aws v4.2.0...
</span></span><span class=line><span class=cl>- Installed hashicorp/aws v4.2.0 <span class=o>(</span>signed by HashiCorp<span class=o>)</span>
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><br><h3 id=5-테라폼-적용 class="relative group">5. 테라폼 적용 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#5-%ed%85%8c%eb%9d%bc%ed%8f%bc-%ec%a0%81%ec%9a%a9 aria-label=Anchor>#</a></span></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform apply
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform apply
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform used the selected providers to generate the following execution
</span></span><span class=line><span class=cl>plan. Resource actions are indicated with the following symbols:
</span></span><span class=line><span class=cl>  + create
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform will perform the following actions:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># aws_instance.example will be created</span>
</span></span><span class=line><span class=cl>  + resource <span class=s2>&#34;aws_instance&#34;</span> <span class=s2>&#34;example&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      + <span class=nv>ami</span>                                  <span class=o>=</span> <span class=s2>&#34;ami-0dd97ebb907cf9366&#34;</span>
</span></span><span class=line><span class=cl>      + <span class=nv>arn</span>                                  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>associate_public_ip_address</span>          <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>availability_zone</span>                    <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>cpu_core_count</span>                       <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>cpu_threads_per_core</span>                 <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>disable_api_termination</span>              <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>ebs_optimized</span>                        <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>get_password_data</span>                    <span class=o>=</span> <span class=nb>false</span>
</span></span><span class=line><span class=cl>      + <span class=nv>host_id</span>                              <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>id</span>                                   <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>instance_initiated_shutdown_behavior</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>instance_state</span>                       <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>instance_type</span>                        <span class=o>=</span> <span class=s2>&#34;t2.micro&#34;</span>
</span></span><span class=line><span class=cl>      + <span class=nv>ipv6_address_count</span>                   <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>ipv6_addresses</span>                       <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>key_name</span>                             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>monitoring</span>                           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>outpost_arn</span>                          <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>password_data</span>                        <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>placement_group</span>                      <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>placement_partition_number</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>primary_network_interface_id</span>         <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>private_dns</span>                          <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>private_ip</span>                           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>public_dns</span>                           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>public_ip</span>                            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>secondary_private_ips</span>                <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>security_groups</span>                      <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>source_dest_check</span>                    <span class=o>=</span> <span class=nb>true</span>
</span></span><span class=line><span class=cl>      + <span class=nv>subnet_id</span>                            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>tags_all</span>                             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>tenancy</span>                              <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>user_data</span>                            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>user_data_base64</span>                     <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>      + <span class=nv>vpc_security_group_ids</span>               <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + capacity_reservation_specification <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>capacity_reservation_preference</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          + capacity_reservation_target <span class=o>{</span>
</span></span><span class=line><span class=cl>              + <span class=nv>capacity_reservation_id</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + ebs_block_device <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>delete_on_termination</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>device_name</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>encrypted</span>             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>iops</span>                  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>kms_key_id</span>            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>snapshot_id</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>tags</span>                  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>throughput</span>            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_id</span>             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_size</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_type</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + enclave_options <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>enabled</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + ephemeral_block_device <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>device_name</span>  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>no_device</span>    <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>virtual_name</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + metadata_options <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>http_endpoint</span>               <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>http_put_response_hop_limit</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>http_tokens</span>                 <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>instance_metadata_tags</span>      <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + network_interface <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>delete_on_termination</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>device_index</span>          <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>network_interface_id</span>  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      + root_block_device <span class=o>{</span>
</span></span><span class=line><span class=cl>          + <span class=nv>delete_on_termination</span> <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>device_name</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>encrypted</span>             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>iops</span>                  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>kms_key_id</span>            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>tags</span>                  <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>throughput</span>            <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_id</span>             <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_size</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>          + <span class=nv>volume_type</span>           <span class=o>=</span> <span class=o>(</span>known after apply<span class=o>)</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Plan: <span class=m>1</span> to add, <span class=m>0</span> to change, <span class=m>0</span> to destroy.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you want to perform these actions?
</span></span><span class=line><span class=cl>  Terraform will perform the actions described above.
</span></span><span class=line><span class=cl>  Only <span class=s1>&#39;yes&#39;</span> will be accepted to approve.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Enter a value:
</span></span></code></pre></div><p>엄청난 양의 생성계획(Plan) 정보가 출력된다. 여기서 <code>(known after apply)</code>는 말그대로 실제 적용 후에 확인 가능한 값이라는 뜻이다.</p><br><p>실행 여부를 묻는 질문에 <code>yes</code> 를 입력 후 [Enter]</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  Enter a value: yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws_instance.example: Creating...
</span></span><span class=line><span class=cl>aws_instance.example: Still creating... <span class=o>[</span>10s elapsed<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Still creating... <span class=o>[</span>20s elapsed<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Creation <span class=nb>complete</span> after 21s <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Apply complete! Resources: <span class=m>1</span> added, <span class=m>0</span> changed, <span class=m>0</span> destroyed.
</span></span></code></pre></div><p>마지막 라인에 1개의 리소스가 정상 생성되었다(<code>1 added</code>)고 결과가 출력되었다.</p><br><p>AWS Management Console에서도 EC2 Instance 1대가 새로 생성되었는지 확인해본다.</p><p><figure><img class="my-0 rounded-md" src=./3.jpg alt></figure></p><p>EC2 Instance 1대가 생성된 후 정상 동작중(<code>Running</code>)이다.</p><br><h3 id=6-삭제 class="relative group">6. 삭제 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#6-%ec%82%ad%ec%a0%9c aria-label=Anchor>#</a></span></h3><p>EC2 Instance를 계속 켜놓으면 비용이 발생한다. 이제 Terraform으로 생성한 EC2 Instance를 다시 삭제해보자.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform destroy
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ terraform destroy
</span></span><span class=line><span class=cl>aws_instance.example: Refreshing state... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform used the selected providers to generate the following execution
</span></span><span class=line><span class=cl>plan. Resource actions are indicated with the following symbols:
</span></span><span class=line><span class=cl>  - destroy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Terraform will perform the following actions:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># aws_instance.example will be destroyed</span>
</span></span><span class=line><span class=cl>  - resource <span class=s2>&#34;aws_instance&#34;</span> <span class=s2>&#34;example&#34;</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      - <span class=nv>ami</span>                                  <span class=o>=</span> <span class=s2>&#34;ami-0dd97ebb907cf9366&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>arn</span>                                  <span class=o>=</span> <span class=s2>&#34;arn:aws:ec2:ap-northeast-2:516381095819:instance/i-082bf1d8b3de239c8&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>associate_public_ip_address</span>          <span class=o>=</span> <span class=nb>true</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>availability_zone</span>                    <span class=o>=</span> <span class=s2>&#34;ap-northeast-2a&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>cpu_core_count</span>                       <span class=o>=</span> <span class=m>1</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>cpu_threads_per_core</span>                 <span class=o>=</span> <span class=m>1</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>disable_api_termination</span>              <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>ebs_optimized</span>                        <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>get_password_data</span>                    <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>hibernation</span>                          <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>id</span>                                   <span class=o>=</span> <span class=s2>&#34;i-082bf1d8b3de239c8&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>instance_initiated_shutdown_behavior</span> <span class=o>=</span> <span class=s2>&#34;stop&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>instance_state</span>                       <span class=o>=</span> <span class=s2>&#34;running&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>instance_type</span>                        <span class=o>=</span> <span class=s2>&#34;t2.micro&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>ipv6_address_count</span>                   <span class=o>=</span> <span class=m>0</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>ipv6_addresses</span>                       <span class=o>=</span> <span class=o>[]</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>monitoring</span>                           <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>primary_network_interface_id</span>         <span class=o>=</span> <span class=s2>&#34;eni-0ca186f601dfde6d4&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>private_dns</span>                          <span class=o>=</span> <span class=s2>&#34;ip-172-31-0-60.ap-northeast-2.compute.internal&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>private_ip</span>                           <span class=o>=</span> <span class=s2>&#34;172.31.0.60&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>public_dns</span>                           <span class=o>=</span> <span class=s2>&#34;ec2-3-35-219-159.ap-northeast-2.compute.amazonaws.com&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>public_ip</span>                            <span class=o>=</span> <span class=s2>&#34;3.35.219.159&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>secondary_private_ips</span>                <span class=o>=</span> <span class=o>[]</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>security_groups</span>                      <span class=o>=</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>          - <span class=s2>&#34;default&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=o>]</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>source_dest_check</span>                    <span class=o>=</span> <span class=nb>true</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>subnet_id</span>                            <span class=o>=</span> <span class=s2>&#34;subnet-8d7ec4e6&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>tags</span>                                 <span class=o>=</span> <span class=o>{}</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>tags_all</span>                             <span class=o>=</span> <span class=o>{}</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>tenancy</span>                              <span class=o>=</span> <span class=s2>&#34;default&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>      - <span class=nv>vpc_security_group_ids</span>               <span class=o>=</span> <span class=o>[</span>
</span></span><span class=line><span class=cl>          - <span class=s2>&#34;sg-58799024&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=o>]</span> -&gt; null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      - capacity_reservation_specification <span class=o>{</span>
</span></span><span class=line><span class=cl>          - <span class=nv>capacity_reservation_preference</span> <span class=o>=</span> <span class=s2>&#34;open&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      - credit_specification <span class=o>{</span>
</span></span><span class=line><span class=cl>          - <span class=nv>cpu_credits</span> <span class=o>=</span> <span class=s2>&#34;standard&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      - enclave_options <span class=o>{</span>
</span></span><span class=line><span class=cl>          - <span class=nv>enabled</span> <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      - metadata_options <span class=o>{</span>
</span></span><span class=line><span class=cl>          - <span class=nv>http_endpoint</span>               <span class=o>=</span> <span class=s2>&#34;enabled&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>http_put_response_hop_limit</span> <span class=o>=</span> <span class=m>1</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>http_tokens</span>                 <span class=o>=</span> <span class=s2>&#34;optional&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>instance_metadata_tags</span>      <span class=o>=</span> <span class=s2>&#34;disabled&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      - root_block_device <span class=o>{</span>
</span></span><span class=line><span class=cl>          - <span class=nv>delete_on_termination</span> <span class=o>=</span> <span class=nb>true</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>device_name</span>           <span class=o>=</span> <span class=s2>&#34;/dev/sda1&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>encrypted</span>             <span class=o>=</span> <span class=nb>false</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>iops</span>                  <span class=o>=</span> <span class=m>100</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>tags</span>                  <span class=o>=</span> <span class=o>{}</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>throughput</span>            <span class=o>=</span> <span class=m>0</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>volume_id</span>             <span class=o>=</span> <span class=s2>&#34;vol-01302622a80fb4b39&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>volume_size</span>           <span class=o>=</span> <span class=m>8</span> -&gt; null
</span></span><span class=line><span class=cl>          - <span class=nv>volume_type</span>           <span class=o>=</span> <span class=s2>&#34;gp2&#34;</span> -&gt; null
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Plan: <span class=m>0</span> to add, <span class=m>0</span> to change, <span class=m>1</span> to destroy.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Do you really want to destroy all resources?
</span></span><span class=line><span class=cl>  Terraform will destroy all your managed infrastructure, as shown above.
</span></span><span class=line><span class=cl>  There is no undo. Only <span class=s1>&#39;yes&#39;</span> will be accepted to confirm.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Enter a value:
</span></span></code></pre></div><p>삭제를 실행하면 대량의 상태 정보가 바뀔 것을 미리 알려주면서, 정말로 실행할 것인지 묻는다.<br><code>yes</code> 입력 후 [Enter] 키를 입력한다.</p><br><p>EC2 Instance 1대를 제거하는 데 약 40초 걸렸다.<br>EC2 Instance를 만들면서 추가적으로 생성된 다른 자원들이 생각보다 많기 때문이다. (EBS, Security Group, ENI 등)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  Enter a value: yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>aws_instance.example: Destroying... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Still destroying... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8, 10s elapsed<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Still destroying... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8, 20s elapsed<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Still destroying... <span class=o>[</span><span class=nv>id</span><span class=o>=</span>i-082bf1d8b3de239c8, 30s elapsed<span class=o>]</span>
</span></span><span class=line><span class=cl>aws_instance.example: Destruction <span class=nb>complete</span> after 40s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Destroy complete! Resources: <span class=m>1</span> destroyed.
</span></span></code></pre></div><p>마지막 줄에 1개의 리소스가 정상 삭제되었다고 나온다. (<code>1 destroyed.</code>)</p><br><p><figure><img class="my-0 rounded-md" src=./4.png alt></figure></p><p>AWS Management Console에서 확인해봐도 EC2 Instance가 삭제(<code>Terminated</code>)된 것을 볼 수 있다.</p><br><h1 id=결론 class="relative group">결론 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#%ea%b2%b0%eb%a1%a0 aria-label=Anchor>#</a></span></h1><p>코드로 인프라를 관리하면 일관성 있는 상태를 유지하고, 이력 관리도 편하며, 인프라 배포/관리를 자동화할 수 있다.<br>편하게 일하고 싶은 Cloud Engineer라면 인프라 구축 자동화 툴인 Terraform을 꼭 배워놓자!</p></div></section><footer class="pt-8 max-w-prose print:hidden"><script src=https://utteranc.es/client.js repo=seyslee/seyslee.github.io issue-term=pathname label=blog-comment theme=github-dark crossorigin=anonymous async></script></footer></article></main><footer class="py-10 print:hidden"><div class="flex justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2022
Younsung Lee</p></div></div></footer></div></body></html>